useDynLib(lme4a)
#useDynLib(lme4a, .registration=TRUE)

## Import non-base functions we need explicitly,
## notably for which we define methods:


## FIXME -- really need all these three ??
import("grid")
import("lattice")
import("splines")
import("Rcpp")

importFrom("graphics", plot)
importFrom("nlme", fixef, ranef, VarCorr)
importFrom("stats4", AIC, BIC, logLik)# so S4 methods are used!
importFrom("stats",
           anova, coef, coefficients, confint, deviance,
           fitted, fitted.values, formula,
           model.frame, model.matrix, predict, profile,
           residuals, resid, simulate, terms
           , update
           , vcov)

importFrom("minqa", bobyqa)

importClassesFrom("Matrix",
                  CHMfactor,
                  CHMsimpl,
                  CHMsuper,
                  Cholesky,
                  Matrix,
                  corMatrix,
                  dCHMsimpl,
                  dCHMsuper,
                  dMatrix,
                  ddiMatrix,
                  dgCMatrix,
                  dgeMatrix,
                  dpoMatrix,
                  dsCMatrix,
                  nCHMsimpl,
                  nCHMsuper,
                  symmetricMatrix)

importFrom("MatrixModels"
           , getCall
           , mkRespMod
           , reweightPred
#           , update
           , updateMu
           , updateWts
           )

importClassesFrom("MatrixModels",
                  modelMatrix,
                  denseModelMatrix,  ddenseModelMatrix,
                  sparseModelMatrix, dsparseModelMatrix,
                  predModule,
                  dPredModule,
                  sPredModule,
                  respModule,
                  glmRespMod,
                  nlsRespMod)

## from MatrixModels, methods too {not just generics from 'stats'}:
importMethodsFrom("MatrixModels",
                  coef, coefficients, fitted, fitted.values,
                  formula, residuals, resid,
                  update)

importMethodsFrom("Matrix"
                  , "%*%"
                  , Cholesky
                  , as.vector
                  , chol
                  , chol2inv
                  , coerce
                  , crossprod
                  , determinant
                  , diag
		  , rcond
                  , solve
                  , summary
                  , t
                  , tcrossprod
                  , update
                  )

## exportPattern("^[^\\.]")

## re-export imported S4 generics
export(AIC, BIC, logLik)
## and the rest (S3 generics; regular functions):
export(VarCorr,
       bootMer,
       devcomp,
       findbars,
       getL,
       glmFamily,
       glmerResp,
       glmer,
       isNested,
       lmList,
       lmerResp,
       lmer,
       mkdevfun,
       nlmer,
#       nlmerResp,       
       nobars,
       sigma,
       subbars
       )

exportClasses(deFeMod, lmerResp, lmList, merMod,
              reModule, reTrms, spFeMod)

exportMethods(VarCorr, anova, coef, coerce, confint, deviance,
              devcomp, fitted, fixef, formula, getL,
              logLik, model.frame, model.matrix, terms,
	      plot, print, profile, ranef, rcond,
              show, simulate, sigma, summary, update, vcov)

S3method(plot, coef.mer)
S3method(dotplot, coef.mer)
S3method(plot, ranef.mer)
S3method(qqmath, ranef.mer)
S3method(dotplot, ranef.mer)
## profile() related:
S3method(xyplot, thpr)
S3method(confint, thpr)
S3method(splom, thpr)
S3method(log, thpr)
