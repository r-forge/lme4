<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>lme4: lmer.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.3 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
  </ul>
</div>
<h1>lmer.c File Reference</h1>
<p>
<code>#include &quot;<a class="el" href="lmer_8h-source.html">lmer.h</a>&quot;</code><br>
<code>#include &lt;Rmath.h&gt;</code><br>
<code>#include &lt;R_ext/Lapack.h&gt;</code><br>
<code>#include &lt;R_ext/stats_package.h&gt;</code><br>
<code>#include &quot;Matrix.h&quot;</code><br>
<code>#include &quot;<a class="el" href="Syms_8h-source.html">Syms.h</a>&quot;</code><br>

<p>
<div class="dynheader">
Include dependency graph for lmer.c:</div>
<div class="dynsection">
<p><center><img src="lmer_8c__incl.png" border="0" usemap="#lmer.c_map" alt=""></center>
<map name="lmer.c_map">
<area shape="rect" href="lmer_8h.html" title="lmer.h" alt="" coords="40,84,101,111"><area shape="rect" href="Syms_8h.html" title="Syms.h" alt="" coords="659,84,728,111"></map>
</div>

<p>
<a href="lmer_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#32a3cf3d9dd914f5aeeca5423c157934">_</a>(String)&nbsp;&nbsp;&nbsp;(String)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">i18n of error messages  <a href="#32a3cf3d9dd914f5aeeca5423c157934"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#679ceea530c97713d6abdb619e70a6b9">Alloca</a>(n, t)&nbsp;&nbsp;&nbsp;(t *) alloca( (size_t) ( (n) * sizeof(t) ) )</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">alloca n elements of type t  <a href="#679ceea530c97713d6abdb619e70a6b9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#8388ab26cceddaa6efaccc3c51add430">AZERO</a>(x, n)&nbsp;&nbsp;&nbsp;{int _I_, _SZ_ = (n); for(_I_ = 0; _I_ &lt; _SZ_; _I_++) (x)[_I_] = 0;}</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">zero an array  <a href="#8388ab26cceddaa6efaccc3c51add430"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#6821bafc3c88dfb2e433a095df9940c6">BUF_SIZE</a>&nbsp;&nbsp;&nbsp;127</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">size of buffer for an error message  <a href="#6821bafc3c88dfb2e433a095df9940c6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#a5f8be62503652a5255cc2faa4d2bfae">CM_MAXITER</a>&nbsp;&nbsp;&nbsp;300</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Maximum number of iterations in update_u.  <a href="#a5f8be62503652a5255cc2faa4d2bfae"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#baa2a0cbd2af97b4692872efd50e7c96">CM_SMIN</a>&nbsp;&nbsp;&nbsp;1e-5</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Minimum step factor in update_u.  <a href="#baa2a0cbd2af97b4692872efd50e7c96"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#bc58fbb47cbe0c7c8c42710fd92d7600">CM_TOL</a>&nbsp;&nbsp;&nbsp;1e-10</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Tolerance level for convergence criterion in update_u.  <a href="#bc58fbb47cbe0c7c8c42710fd92d7600"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#94e6667644d2b670654fc46d3cf0ee1b">L_SLOT</a>(x)&nbsp;&nbsp;&nbsp;AS_CHM_FR(GET_SLOT(x, <a class="el" href="Syms_8h.html#1c5173cb2d24e6601e9cd7f68f2df7d2">lme4_LSym</a>))</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extract the L slot, convert it to a cholmod_factor struct and return a pointer.  <a href="#94e6667644d2b670654fc46d3cf0ee1b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#fdd34e4567fa4416a01a2167812f00a4">RDF</a>(dims)&nbsp;&nbsp;&nbsp;(dims[n_POS] - (dims[isREML_POS] ? dims[p_POS] : 0))</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Residual degrees of freedom.  <a href="#fdd34e4567fa4416a01a2167812f00a4"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#2ef82a9439b964c1e545fb6487a5e3ac">devP</a> { <a class="el" href="lmer_8c.html#2ef82a9439b964c1e545fb6487a5e3ac0966f1b2ecf23e6ad09c98b24e671969">ML_POS</a> = 0, 
<a class="el" href="lmer_8c.html#2ef82a9439b964c1e545fb6487a5e3ac7a80b999acd82e5cbb3cf97973aa78ea">REML_POS</a>, 
<a class="el" href="lmer_8c.html#2ef82a9439b964c1e545fb6487a5e3ac1f383bef04b44158a36fcbc7448ff209">ldL2_POS</a>, 
<a class="el" href="lmer_8c.html#2ef82a9439b964c1e545fb6487a5e3ac88f23d25bffc837e71115357097fde7c">ldRX2_POS</a>, 
<a class="el" href="lmer_8c.html#2ef82a9439b964c1e545fb6487a5e3ac521e4a1105b29f04c2dac6b8db8cc7d7">pwrss_POS</a>, 
<a class="el" href="lmer_8c.html#2ef82a9439b964c1e545fb6487a5e3ac2fc47e8fe2aa1a4af11c9bbfd9ad3a61">disc_POS</a>, 
<a class="el" href="lmer_8c.html#2ef82a9439b964c1e545fb6487a5e3ac80414cb7465f31adb27424aa695b382e">usqr_POS</a>, 
<a class="el" href="lmer_8c.html#2ef82a9439b964c1e545fb6487a5e3ace7249a5feae526dd06a2b35bcb0f834a">wrss_POS</a>
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">positions in the deviance vector  <a href="lmer_8c.html#2ef82a9439b964c1e545fb6487a5e3ac">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#d4ed7f6a53d33bda670d5b7dbea3bcba">dimP</a> { <br>
&nbsp;&nbsp;<a class="el" href="lmer_8c.html#d4ed7f6a53d33bda670d5b7dbea3bcbaafdfe3e96c82c637dec9623a20c28e2d">nf_POS</a> = 0, 
<a class="el" href="lmer_8c.html#d4ed7f6a53d33bda670d5b7dbea3bcbaccc72a17eae16e4f222f4a5a088afcd9">n_POS</a>, 
<a class="el" href="lmer_8c.html#d4ed7f6a53d33bda670d5b7dbea3bcba193cdfb875a2d07bbbd3a5587879281b">p_POS</a>, 
<a class="el" href="lmer_8c.html#d4ed7f6a53d33bda670d5b7dbea3bcba37d963697202d840d6555705f0d84ce5">q_POS</a>, 
<a class="el" href="lmer_8c.html#d4ed7f6a53d33bda670d5b7dbea3bcba91cd64ccd89cc2464e243909b1fe80d0">s_POS</a>, 
<a class="el" href="lmer_8c.html#d4ed7f6a53d33bda670d5b7dbea3bcba2b797f093d02ad8ae18e2df853ddbeb2">np_POS</a>, 
<a class="el" href="lmer_8c.html#d4ed7f6a53d33bda670d5b7dbea3bcba43f2bd1e217872fe65753fc44dc9c8b0">isREML_POS</a>, 
<a class="el" href="lmer_8c.html#d4ed7f6a53d33bda670d5b7dbea3bcbab981414431eebe619c7773f2960aaab4">fTyp_POS</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="lmer_8c.html#d4ed7f6a53d33bda670d5b7dbea3bcbadfa87566bea1ae1bc8d65574e3fe6008">lTyp_POS</a>, 
<a class="el" href="lmer_8c.html#d4ed7f6a53d33bda670d5b7dbea3bcbafb29d685fb80ecb48d440c224982de91">vTyp_POS</a>, 
<a class="el" href="lmer_8c.html#d4ed7f6a53d33bda670d5b7dbea3bcba68eaf00e048e68cfda17881a75130ae2">nest_POS</a>, 
<a class="el" href="lmer_8c.html#d4ed7f6a53d33bda670d5b7dbea3bcbadafe9a1ae435a2f525c63feb97556dd2">useSc_POS</a>, 
<a class="el" href="lmer_8c.html#d4ed7f6a53d33bda670d5b7dbea3bcba3c653205ba325a47efabda0ef044462e">cvg_POS</a>
<br>
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">positions in the dims vector  <a href="lmer_8c.html#d4ed7f6a53d33bda670d5b7dbea3bcba">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static R_INLINE double *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#717cadc4d5964b559d0e6507e6e680ed">apply_iperm</a> (double *dest, const double *src, const int *perm, int n)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Permute the vector src according to the inverse of perm into dest.  <a href="#717cadc4d5964b559d0e6507e6e680ed"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static R_INLINE double *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#c6c092e8b91bd83d19519bdc69bf6801">apply_perm</a> (double *dest, const double *src, const int *perm, int n)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Permute the vector src according to perm into dest.  <a href="#c6c092e8b91bd83d19519bdc69bf6801"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#119582eec2ad35c9d9516dcb3a927750">chkDims</a> (char *buf, int nb, SEXP x, SEXP sym, int nr, int nc)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check that slot sym of object x is a numeric matrix of dimension nr by nc.  <a href="#119582eec2ad35c9d9516dcb3a927750"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#617426914114d8f8cd8249de16ddc8e1">chkLen</a> (char *buf, int nb, SEXP x, SEXP sym, int len, int zerok)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check that the length of the sym slot in x is len or, possibly, zero.  <a href="#617426914114d8f8cd8249de16ddc8e1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static R_INLINE double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#0b9684f5bbd166540f692843a07c0604">get_sigma</a> (int REML, const int *dims, const double *d)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the REML or ML conditional estimate of sigma, the standard deviation of the per-observation noise term.  <a href="#0b9684f5bbd166540f692843a07c0604"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static R_INLINE int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#3f49a530ee30ef0d40ef8bc6d60c5963">Gp_grp</a> (int ind, int nf, const int *Gp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the group in the (nf, Gp) combination to which ind belongs.  <a href="#3f49a530ee30ef0d40ef8bc6d60c5963"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#2f1d1f23db416c858fe8eecd2bb35236">lme4_devResid</a> (const double *mu, const double *pWt, const double *y, int n, int vTyp)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#4a0a18cf109ccc29a71a27a7f12bf4a7">lme4_muEta</a> (double *mu, double *muEta, const double *eta, int n, int typ)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">SEXP&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#3e5fbf4c0511166682d134b8b4c68502">lme4_rWishart</a> (SEXP ns, SEXP dfp, SEXP scal)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Simulate a sample of random matrices from a Wishart distribution.  <a href="#3e5fbf4c0511166682d134b8b4c68502"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#a5f4cdbae42bcf865082dea1ebe09357">lme4_varFunc</a> (double *var, const double *mu, int n, int vTyp)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#f1bc9174690e2956720aa31781b073f0">MCMC_beta</a> (SEXP x, double sigma)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the fixed effects in an MCMC sample from an mer object.  <a href="#f1bc9174690e2956720aa31781b073f0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static R_INLINE double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#c8a525d9fe2317c0b658051821bdc754">MCMC_sigma</a> (const int *dims, const double *d)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generate a new value of sigma, the common scale parameter, for an mer object.  <a href="#c8a525d9fe2317c0b658051821bdc754"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#ef128b4cee2e476298b3b4388d8a2097">MCMC_ST</a> (SEXP x, double sigma, double *vals, int trans)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#0903b0858c61e7e394c4dfb5f2661748">MCMC_u</a> (SEXP x, double sigma)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the orthogonal random effects in an MCMC sample from an mer object.  <a href="#0903b0858c61e7e394c4dfb5f2661748"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SEXP&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#f0bf2e6ee95fd84db9323208711ae3bc">mer_create_L</a> (SEXP CmP)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create and initialize L.  <a href="#f0bf2e6ee95fd84db9323208711ae3bc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SEXP&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#8f6debb5f78c3602ed0d576add360e68">mer_MCMCsamp</a> (SEXP x, SEXP savebp, SEXP nsampp, SEXP transp, SEXP verbosep, SEXP deviancep)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generate a Markov-chain Monte Carlo sample from an mer object.  <a href="#8f6debb5f78c3602ed0d576add360e68"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SEXP&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#7aa21aea1da63a3096fcc054cc6c9dd5">mer_optimize</a> (SEXP x, SEXP verbp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Optimize the profiled deviance of an lmer object or the Laplace approximation to the deviance of a nlmer or glmer object.  <a href="#7aa21aea1da63a3096fcc054cc6c9dd5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SEXP&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#79178d4c0ab3956a7f5d5ac93416759a">mer_postVar</a> (SEXP x)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extract the posterior variances of the random effects in an mer object.  <a href="#79178d4c0ab3956a7f5d5ac93416759a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SEXP&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#1c7078c50d8111387e40b202e2e94506">mer_sigma</a> (SEXP x, SEXP which)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extract the estimate of the common scale parameter from an mer object.  <a href="#1c7078c50d8111387e40b202e2e94506"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SEXP&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#1f6b9123d7b4dcbe24cc9085e5f4069a">mer_ST_getPars</a> (SEXP x)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extract the parameters from the ST slot of an mer object.  <a href="#1f6b9123d7b4dcbe24cc9085e5f4069a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SEXP&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#0a12a0220833deaf108e01ca3ecaac51">mer_ST_initialize</a> (SEXP ST, SEXP Gpp, SEXP Zt)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Evaluate starting estimates for the elements of ST.  <a href="#0a12a0220833deaf108e01ca3ecaac51"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SEXP&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#96765a284e1652326a22d50f7d7538d4">mer_ST_setPars</a> (SEXP x, SEXP pars)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the ST slot of an mer object from a REAL vector of parameters and update the Cholesky factorization.  <a href="#96765a284e1652326a22d50f7d7538d4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SEXP&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#c33b16395fa975458685d0eb76996f92">mer_update_dev</a> (SEXP x)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Evaluate the discrepancy and log of the penalized discrepancy.  <a href="#c33b16395fa975458685d0eb76996f92"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SEXP&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#f61a89a1f6aa003a5ae87d08cb8c9af7">mer_update_L</a> (SEXP x)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Externally callable update_L.  <a href="#f61a89a1f6aa003a5ae87d08cb8c9af7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SEXP&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#64740a858f90763461cbccea9c787b6b">mer_update_mu</a> (SEXP x)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Externally callable update_mu.  <a href="#64740a858f90763461cbccea9c787b6b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SEXP&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#bc080c9abeb9965118c6d114d6df1cb3">mer_update_ranef</a> (SEXP x)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Externally callable update_ranef.  <a href="#bc080c9abeb9965118c6d114d6df1cb3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SEXP&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#6c02b5f73d659d2d748852fac7e9c462">mer_update_RX</a> (SEXP x)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Externally callable update_RX.  <a href="#6c02b5f73d659d2d748852fac7e9c462"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SEXP&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#b72ec91b1f901b466f29a80bcc22e6c4">mer_update_u</a> (SEXP x, SEXP verbP)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Externally callable update_u.  <a href="#b72ec91b1f901b466f29a80bcc22e6c4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SEXP&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#489500e3d5104fc320a54d85c43bcfed">mer_validate</a> (SEXP x)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check validity of an object that inherits from the mer class.  <a href="#489500e3d5104fc320a54d85c43bcfed"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#d562658adcecf9b4a01944b227be5915">P_sdmult</a> (double *dest, const int *perm, const CHM_SP A, const double *X, int nc)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create PAX in dest.  <a href="#d562658adcecf9b4a01944b227be5915"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SEXP&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#06b081a8a5b894d99de0539549058b15">pedigree_chol</a> (SEXP x, SEXP ans)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create the left Cholesky factor of the numerator relationship matrix from a pedigree.  <a href="#06b081a8a5b894d99de0539549058b15"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">SEXP&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#717631a5aed4d47229922c84b9b1a952">pedigree_inbreeding</a> (SEXP x)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create the inbreeding coefficients according to the algorithm given in "Comparison of four direct algorithms for computing inbreeding coefficients" by Mehdi Sargolzaei and Hiroaki Iwaisaki, Animal Science Journal (2005) 76, 401--406.  <a href="#717631a5aed4d47229922c84b9b1a952"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#24e3fc6b91cae668ea046c4b5e5ff9ed">safe_pd_matrix</a> (double x[], const char uplo[], int n, double thresh)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static R_INLINE double *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#0a84fce1f01d522d8c5379001e23bc8c">SLOT_REAL_NULL</a> (SEXP obj, SEXP nm)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extract the slot named nm from the object obj and return a null pointer if the slot has length 0 or a pointer to the REAL contents.  <a href="#0a84fce1f01d522d8c5379001e23bc8c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static R_INLINE double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#c96e3dd08e67f41338d9e84118925308">sqr_length</a> (const double *x, int n)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the sum of squares of the first n elements of x.  <a href="#c96e3dd08e67f41338d9e84118925308"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static double *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#1d1cc0c037f6827ce66c5aa1db650224">ST_getPars</a> (SEXP x, double *pars)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extract the parameters from ST list.  <a href="#1d1cc0c037f6827ce66c5aa1db650224"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#3a7fab2a88117d83971db12f53eaa91e">ST_nc_nlev</a> (const SEXP ST, const int *Gp, double **st, int *nc, int *nlev)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Populate the st, nc and nlev arrays.  <a href="#3a7fab2a88117d83971db12f53eaa91e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#c91a1d6467c5dd44cbc4c785f643e315">ST_setPars</a> (SEXP x, const double *pars)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the ST and C slots of an mer object.  <a href="#c91a1d6467c5dd44cbc4c785f643e315"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static double *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#9812644aac7804e273e0a48e138eb9f9">std_rWishart_factor</a> (double df, int p, int upper, double ans[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Simulate the Cholesky factor of a standardized Wishart variate with dimension p and df degrees of freedom.  <a href="#9812644aac7804e273e0a48e138eb9f9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#2f257f628f06920b351486d48ab50026">update_L</a> (SEXP x)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the A, L, sqrtrWt and resid slots.  <a href="#2f257f628f06920b351486d48ab50026"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#da558f58458c36a96585a9c6e695a0b6">update_mu</a> (SEXP x)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the eta, v, mu, resid and var slots according to the current values of the parameters and u.  <a href="#da558f58458c36a96585a9c6e695a0b6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#5542c4de7dbcdbb6630cad8fabe96542">update_ranef</a> (SEXP x)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the contents of the ranef slot in an mer object.  <a href="#5542c4de7dbcdbb6630cad8fabe96542"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#2c7f7874e2eb3f6c51c53c5873cffec4">update_RX</a> (SEXP x)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the RCX and RX slots in an mer object.  <a href="#2c7f7874e2eb3f6c51c53c5873cffec4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#88236137756e85a656de3402adcf4747">update_u</a> (SEXP x, int verb)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Iterate to determine the conditional modes of the random effects.  <a href="#88236137756e85a656de3402adcf4747"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static R_INLINE double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#5023a36a5ff0bec88db074b701eaf563">y_log_y</a> (double y, double mu)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Evaluate y * log(y/mu) with the correct limiting value at y = 0.  <a href="#5023a36a5ff0bec88db074b701eaf563"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">cholmod_common&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#c2b5dcf1f18e620b15b2e284dd9f6bd4">c</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">cholmod_common struct initialized in R_init_lme4  <a href="#c2b5dcf1f18e620b15b2e284dd9f6bd4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static const double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#ff6b0bb93de5846a13b97b193ae85a19">INVEPS</a> = 1/DOUBLE_EPS</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#19bc482347f198c78c8fcfb3e2510425">LTHRESH</a> = 30.</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#6b3a6b2cbf7064ca416501ccda92fbb9">MLTHRESH</a> = -30.</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#b3b4cee60f1fb4a51a943b4e14ca01e1">MPTHRESH</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lmer_8c.html#facf87e3fb517a5633a98660f2d34b87">PTHRESH</a> = 0</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="32a3cf3d9dd914f5aeeca5423c157934"></a><!-- doxytag: member="lmer.c::_" ref="32a3cf3d9dd914f5aeeca5423c157934" args="(String)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _          </td>
          <td>(</td>
          <td class="paramtype">String&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;(String)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
i18n of error messages 
<p>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00016">16</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01704">chkDims()</a>, <a class="el" href="lmer_8c-source.html#l01727">chkLen()</a>, <a class="el" href="lmer_8c-source.html#l00133">Gp_grp()</a>, <a class="el" href="lmer_8c-source.html#l00685">lme4_devResid()</a>, <a class="el" href="lmer_8c-source.html#l00588">lme4_muEta()</a>, <a class="el" href="lmer_8c-source.html#l00636">lme4_varFunc()</a>, <a class="el" href="lmer_8c-source.html#l01538">MCMC_ST()</a>, <a class="el" href="lmer_8c-source.html#l00563">mer_create_L()</a>, <a class="el" href="lmer_8c-source.html#l00466">mer_ST_setPars()</a>, <a class="el" href="lmer_8c-source.html#l01745">mer_validate()</a>, <a class="el" href="lmer_8c-source.html#l01521">safe_pd_matrix()</a>, <a class="el" href="lmer_8c-source.html#l00391">ST_setPars()</a>, <a class="el" href="lmer_8c-source.html#l00842">update_L()</a>, <a class="el" href="lmer_8c-source.html#l00725">update_mu()</a>, <a class="el" href="lmer_8c-source.html#l00253">update_ranef()</a>, <a class="el" href="lmer_8c-source.html#l01206">update_RX()</a>, and <a class="el" href="lmer_8c-source.html#l00972">update_u()</a>.</p>

</div>
</div><p>
<a class="anchor" name="679ceea530c97713d6abdb619e70a6b9"></a><!-- doxytag: member="lmer.c::Alloca" ref="679ceea530c97713d6abdb619e70a6b9" args="(n, t)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define Alloca          </td>
          <td>(</td>
          <td class="paramtype">n,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">t&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;(t *) alloca( (size_t) ( (n) * sizeof(t) ) )</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
alloca n elements of type t 
<p>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00033">33</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01428">lme4_rWishart()</a>, <a class="el" href="lmer_8c-source.html#l01479">MCMC_beta()</a>, <a class="el" href="lmer_8c-source.html#l01538">MCMC_ST()</a>, <a class="el" href="lmer_8c-source.html#l01319">mer_optimize()</a>, <a class="el" href="lmer_8c-source.html#l00500">mer_postVar()</a>, <a class="el" href="lmer_8c-source.html#l00311">mer_ST_initialize()</a>, <a class="el" href="lmer_8c-source.html#l01745">mer_validate()</a>, <a class="el" href="lmer_8c-source.html#l01181">P_sdmult()</a>, <a class="el" href="lmer_8c-source.html#l01881">pedigree_inbreeding()</a>, <a class="el" href="lmer_8c-source.html#l01521">safe_pd_matrix()</a>, <a class="el" href="lmer_8c-source.html#l00391">ST_setPars()</a>, <a class="el" href="lmer_8c-source.html#l00253">update_ranef()</a>, and <a class="el" href="lmer_8c-source.html#l00972">update_u()</a>.</p>

</div>
</div><p>
<a class="anchor" name="8388ab26cceddaa6efaccc3c51add430"></a><!-- doxytag: member="lmer.c::AZERO" ref="8388ab26cceddaa6efaccc3c51add430" args="(x, n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AZERO          </td>
          <td>(</td>
          <td class="paramtype">x,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">n&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;{int _I_, _SZ_ = (n); for(_I_ = 0; _I_ &lt; _SZ_; _I_++) (x)[_I_] = 0;}</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
zero an array 
<p>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00036">36</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01428">lme4_rWishart()</a>, <a class="el" href="lmer_8c-source.html#l01538">MCMC_ST()</a>, <a class="el" href="lmer_8c-source.html#l00311">mer_ST_initialize()</a>, <a class="el" href="lmer_8c-source.html#l01181">P_sdmult()</a>, <a class="el" href="lmer_8c-source.html#l00391">ST_setPars()</a>, <a class="el" href="lmer_8c-source.html#l00842">update_L()</a>, <a class="el" href="lmer_8c-source.html#l01206">update_RX()</a>, and <a class="el" href="lmer_8c-source.html#l00972">update_u()</a>.</p>

</div>
</div><p>
<a class="anchor" name="6821bafc3c88dfb2e433a095df9940c6"></a><!-- doxytag: member="lmer.c::BUF_SIZE" ref="6821bafc3c88dfb2e433a095df9940c6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUF_SIZE&nbsp;&nbsp;&nbsp;127          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
size of buffer for an error message 
<p>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l01688">1688</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01704">chkDims()</a>, <a class="el" href="lmer_8c-source.html#l01727">chkLen()</a>, and <a class="el" href="lmer_8c-source.html#l01745">mer_validate()</a>.</p>

</div>
</div><p>
<a class="anchor" name="a5f8be62503652a5255cc2faa4d2bfae"></a><!-- doxytag: member="lmer.c::CM_MAXITER" ref="a5f8be62503652a5255cc2faa4d2bfae" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CM_MAXITER&nbsp;&nbsp;&nbsp;300          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Maximum number of iterations in update_u. 
<p>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00957">957</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l00972">update_u()</a>.</p>

</div>
</div><p>
<a class="anchor" name="baa2a0cbd2af97b4692872efd50e7c96"></a><!-- doxytag: member="lmer.c::CM_SMIN" ref="baa2a0cbd2af97b4692872efd50e7c96" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CM_SMIN&nbsp;&nbsp;&nbsp;1e-5          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Minimum step factor in update_u. 
<p>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00961">961</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l00972">update_u()</a>.</p>

</div>
</div><p>
<a class="anchor" name="bc58fbb47cbe0c7c8c42710fd92d7600"></a><!-- doxytag: member="lmer.c::CM_TOL" ref="bc58fbb47cbe0c7c8c42710fd92d7600" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CM_TOL&nbsp;&nbsp;&nbsp;1e-10          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Tolerance level for convergence criterion in update_u. 
<p>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00959">959</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l00972">update_u()</a>.</p>

</div>
</div><p>
<a class="anchor" name="94e6667644d2b670654fc46d3cf0ee1b"></a><!-- doxytag: member="lmer.c::L_SLOT" ref="94e6667644d2b670654fc46d3cf0ee1b" args="(x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define L_SLOT          </td>
          <td>(</td>
          <td class="paramtype">x&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;AS_CHM_FR(GET_SLOT(x, <a class="el" href="Syms_8h.html#1c5173cb2d24e6601e9cd7f68f2df7d2">lme4_LSym</a>))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Extract the L slot, convert it to a cholmod_factor struct and return a pointer. 
<p>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00070">70</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01479">MCMC_beta()</a>, <a class="el" href="lmer_8c-source.html#l00500">mer_postVar()</a>, <a class="el" href="lmer_8c-source.html#l01745">mer_validate()</a>, <a class="el" href="lmer_8c-source.html#l00842">update_L()</a>, <a class="el" href="lmer_8c-source.html#l00725">update_mu()</a>, <a class="el" href="lmer_8c-source.html#l00253">update_ranef()</a>, <a class="el" href="lmer_8c-source.html#l01206">update_RX()</a>, and <a class="el" href="lmer_8c-source.html#l00972">update_u()</a>.</p>

</div>
</div><p>
<a class="anchor" name="fdd34e4567fa4416a01a2167812f00a4"></a><!-- doxytag: member="lmer.c::RDF" ref="fdd34e4567fa4416a01a2167812f00a4" args="(dims)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RDF          </td>
          <td>(</td>
          <td class="paramtype">dims&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;(dims[n_POS] - (dims[isREML_POS] ? dims[p_POS] : 0))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Residual degrees of freedom. 
<p>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00067">67</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01616">MCMC_sigma()</a>.</p>

</div>
</div><p>
<hr><h2>Enumeration Type Documentation</h2>
<a class="anchor" name="2ef82a9439b964c1e545fb6487a5e3ac"></a><!-- doxytag: member="lmer.c::devP" ref="2ef82a9439b964c1e545fb6487a5e3ac" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="lmer_8c.html#2ef82a9439b964c1e545fb6487a5e3ac">devP</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
positions in the deviance vector 
<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="2ef82a9439b964c1e545fb6487a5e3ac0966f1b2ecf23e6ad09c98b24e671969"></a><!-- doxytag: member="ML_POS" ref="2ef82a9439b964c1e545fb6487a5e3ac0966f1b2ecf23e6ad09c98b24e671969" args="" -->ML_POS</em>&nbsp;</td><td>
Maximum likelihood deviance. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="2ef82a9439b964c1e545fb6487a5e3ac7a80b999acd82e5cbb3cf97973aa78ea"></a><!-- doxytag: member="REML_POS" ref="2ef82a9439b964c1e545fb6487a5e3ac7a80b999acd82e5cbb3cf97973aa78ea" args="" -->REML_POS</em>&nbsp;</td><td>
REML deviance. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="2ef82a9439b964c1e545fb6487a5e3ac1f383bef04b44158a36fcbc7448ff209"></a><!-- doxytag: member="ldL2_POS" ref="2ef82a9439b964c1e545fb6487a5e3ac1f383bef04b44158a36fcbc7448ff209" args="" -->ldL2_POS</em>&nbsp;</td><td>
2*log-determinant of L </td></tr>
<tr><td valign="top"><em><a class="anchor" name="2ef82a9439b964c1e545fb6487a5e3ac88f23d25bffc837e71115357097fde7c"></a><!-- doxytag: member="ldRX2_POS" ref="2ef82a9439b964c1e545fb6487a5e3ac88f23d25bffc837e71115357097fde7c" args="" -->ldRX2_POS</em>&nbsp;</td><td>
2*log-determinant of RX </td></tr>
<tr><td valign="top"><em><a class="anchor" name="2ef82a9439b964c1e545fb6487a5e3ac521e4a1105b29f04c2dac6b8db8cc7d7"></a><!-- doxytag: member="pwrss_POS" ref="2ef82a9439b964c1e545fb6487a5e3ac521e4a1105b29f04c2dac6b8db8cc7d7" args="" -->pwrss_POS</em>&nbsp;</td><td>
penalized, weighted residual sum of squares </td></tr>
<tr><td valign="top"><em><a class="anchor" name="2ef82a9439b964c1e545fb6487a5e3ac2fc47e8fe2aa1a4af11c9bbfd9ad3a61"></a><!-- doxytag: member="disc_POS" ref="2ef82a9439b964c1e545fb6487a5e3ac2fc47e8fe2aa1a4af11c9bbfd9ad3a61" args="" -->disc_POS</em>&nbsp;</td><td>
discrepancy </td></tr>
<tr><td valign="top"><em><a class="anchor" name="2ef82a9439b964c1e545fb6487a5e3ac80414cb7465f31adb27424aa695b382e"></a><!-- doxytag: member="usqr_POS" ref="2ef82a9439b964c1e545fb6487a5e3ac80414cb7465f31adb27424aa695b382e" args="" -->usqr_POS</em>&nbsp;</td><td>
squared length of u </td></tr>
<tr><td valign="top"><em><a class="anchor" name="2ef82a9439b964c1e545fb6487a5e3ace7249a5feae526dd06a2b35bcb0f834a"></a><!-- doxytag: member="wrss_POS" ref="2ef82a9439b964c1e545fb6487a5e3ace7249a5feae526dd06a2b35bcb0f834a" args="" -->wrss_POS</em>&nbsp;</td><td>
weighted residual sum of squares </td></tr>
</table>
</dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00039">39</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="d4ed7f6a53d33bda670d5b7dbea3bcba"></a><!-- doxytag: member="lmer.c::dimP" ref="d4ed7f6a53d33bda670d5b7dbea3bcba" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="lmer_8c.html#d4ed7f6a53d33bda670d5b7dbea3bcba">dimP</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
positions in the dims vector 
<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="d4ed7f6a53d33bda670d5b7dbea3bcbaafdfe3e96c82c637dec9623a20c28e2d"></a><!-- doxytag: member="nf_POS" ref="d4ed7f6a53d33bda670d5b7dbea3bcbaafdfe3e96c82c637dec9623a20c28e2d" args="" -->nf_POS</em>&nbsp;</td><td>
number of terms in random effects </td></tr>
<tr><td valign="top"><em><a class="anchor" name="d4ed7f6a53d33bda670d5b7dbea3bcbaccc72a17eae16e4f222f4a5a088afcd9"></a><!-- doxytag: member="n_POS" ref="d4ed7f6a53d33bda670d5b7dbea3bcbaccc72a17eae16e4f222f4a5a088afcd9" args="" -->n_POS</em>&nbsp;</td><td>
number of observations </td></tr>
<tr><td valign="top"><em><a class="anchor" name="d4ed7f6a53d33bda670d5b7dbea3bcba193cdfb875a2d07bbbd3a5587879281b"></a><!-- doxytag: member="p_POS" ref="d4ed7f6a53d33bda670d5b7dbea3bcba193cdfb875a2d07bbbd3a5587879281b" args="" -->p_POS</em>&nbsp;</td><td>
number of fixed-effects parameters </td></tr>
<tr><td valign="top"><em><a class="anchor" name="d4ed7f6a53d33bda670d5b7dbea3bcba37d963697202d840d6555705f0d84ce5"></a><!-- doxytag: member="q_POS" ref="d4ed7f6a53d33bda670d5b7dbea3bcba37d963697202d840d6555705f0d84ce5" args="" -->q_POS</em>&nbsp;</td><td>
number of random effects </td></tr>
<tr><td valign="top"><em><a class="anchor" name="d4ed7f6a53d33bda670d5b7dbea3bcba91cd64ccd89cc2464e243909b1fe80d0"></a><!-- doxytag: member="s_POS" ref="d4ed7f6a53d33bda670d5b7dbea3bcba91cd64ccd89cc2464e243909b1fe80d0" args="" -->s_POS</em>&nbsp;</td><td>
number of variables in h (1 unless nonlinear) </td></tr>
<tr><td valign="top"><em><a class="anchor" name="d4ed7f6a53d33bda670d5b7dbea3bcba2b797f093d02ad8ae18e2df853ddbeb2"></a><!-- doxytag: member="np_POS" ref="d4ed7f6a53d33bda670d5b7dbea3bcba2b797f093d02ad8ae18e2df853ddbeb2" args="" -->np_POS</em>&nbsp;</td><td>
total number of parameters for T and S </td></tr>
<tr><td valign="top"><em><a class="anchor" name="d4ed7f6a53d33bda670d5b7dbea3bcba43f2bd1e217872fe65753fc44dc9c8b0"></a><!-- doxytag: member="isREML_POS" ref="d4ed7f6a53d33bda670d5b7dbea3bcba43f2bd1e217872fe65753fc44dc9c8b0" args="" -->isREML_POS</em>&nbsp;</td><td>
indicator of REML estimation </td></tr>
<tr><td valign="top"><em><a class="anchor" name="d4ed7f6a53d33bda670d5b7dbea3bcbab981414431eebe619c7773f2960aaab4"></a><!-- doxytag: member="fTyp_POS" ref="d4ed7f6a53d33bda670d5b7dbea3bcbab981414431eebe619c7773f2960aaab4" args="" -->fTyp_POS</em>&nbsp;</td><td>
family type for generalized model </td></tr>
<tr><td valign="top"><em><a class="anchor" name="d4ed7f6a53d33bda670d5b7dbea3bcbadfa87566bea1ae1bc8d65574e3fe6008"></a><!-- doxytag: member="lTyp_POS" ref="d4ed7f6a53d33bda670d5b7dbea3bcbadfa87566bea1ae1bc8d65574e3fe6008" args="" -->lTyp_POS</em>&nbsp;</td><td>
link type for generalized model </td></tr>
<tr><td valign="top"><em><a class="anchor" name="d4ed7f6a53d33bda670d5b7dbea3bcbafb29d685fb80ecb48d440c224982de91"></a><!-- doxytag: member="vTyp_POS" ref="d4ed7f6a53d33bda670d5b7dbea3bcbafb29d685fb80ecb48d440c224982de91" args="" -->vTyp_POS</em>&nbsp;</td><td>
variance type for generalized model </td></tr>
<tr><td valign="top"><em><a class="anchor" name="d4ed7f6a53d33bda670d5b7dbea3bcba68eaf00e048e68cfda17881a75130ae2"></a><!-- doxytag: member="nest_POS" ref="d4ed7f6a53d33bda670d5b7dbea3bcba68eaf00e048e68cfda17881a75130ae2" args="" -->nest_POS</em>&nbsp;</td><td>
indicator of nested grouping factors </td></tr>
<tr><td valign="top"><em><a class="anchor" name="d4ed7f6a53d33bda670d5b7dbea3bcbadafe9a1ae435a2f525c63feb97556dd2"></a><!-- doxytag: member="useSc_POS" ref="d4ed7f6a53d33bda670d5b7dbea3bcbadafe9a1ae435a2f525c63feb97556dd2" args="" -->useSc_POS</em>&nbsp;</td><td>
does the family use a separate scale parameter </td></tr>
<tr><td valign="top"><em><a class="anchor" name="d4ed7f6a53d33bda670d5b7dbea3bcba3c653205ba325a47efabda0ef044462e"></a><!-- doxytag: member="cvg_POS" ref="d4ed7f6a53d33bda670d5b7dbea3bcba3c653205ba325a47efabda0ef044462e" args="" -->cvg_POS</em>&nbsp;</td><td>
convergence indictor from port optimization </td></tr>
</table>
</dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00050">50</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="717cadc4d5964b559d0e6507e6e680ed"></a><!-- doxytag: member="lmer.c::apply_iperm" ref="717cadc4d5964b559d0e6507e6e680ed" args="(double *dest, const double *src, const int *perm, int n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static R_INLINE double* apply_iperm           </td>
          <td>(</td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&nbsp;</td>
          <td class="paramname"> <em>perm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Permute the vector src according to the inverse of perm into dest. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dest</em>&nbsp;</td><td>destination </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>src</em>&nbsp;</td><td>source </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>perm</em>&nbsp;</td><td>NULL or 0-based permutation of length n </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>n</em>&nbsp;</td><td>length of src, dest and perm</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>dest</dd></dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>If perm is NULL the first n elements of src are copied to dest. </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00119">119</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="c6c092e8b91bd83d19519bdc69bf6801"></a><!-- doxytag: member="lmer.c::apply_perm" ref="c6c092e8b91bd83d19519bdc69bf6801" args="(double *dest, const double *src, const int *perm, int n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static R_INLINE double* apply_perm           </td>
          <td>(</td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&nbsp;</td>
          <td class="paramname"> <em>perm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Permute the vector src according to perm into dest. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dest</em>&nbsp;</td><td>destination </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>src</em>&nbsp;</td><td>source </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>perm</em>&nbsp;</td><td>NULL or 0-based permutation of length n </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>n</em>&nbsp;</td><td>length of src, dest and perm</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>dest</dd></dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>If perm is NULL the first n elements of src are copied to dest. </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00100">100</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01181">P_sdmult()</a>, and <a class="el" href="lmer_8c-source.html#l00972">update_u()</a>.</p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_c6c092e8b91bd83d19519bdc69bf6801_icgraph.png" border="0" usemap="#lmer_8c_c6c092e8b91bd83d19519bdc69bf6801_icgraph_map" alt=""></center>
<map name="lmer_8c_c6c092e8b91bd83d19519bdc69bf6801_icgraph_map">
<area shape="rect" href="lmer_8c.html#d562658adcecf9b4a01944b227be5915" title="Create PAX in dest." alt="" coords="153,5,233,32"><area shape="rect" href="lmer_8c.html#88236137756e85a656de3402adcf4747" title="Iterate to determine the conditional modes of the random effects." alt="" coords="153,56,233,83"><area shape="rect" href="lmer_8c.html#2c7f7874e2eb3f6c51c53c5873cffec4" title="Update the RCX and RX slots in an mer object." alt="" coords="295,5,385,32"><area shape="rect" href="lmer_8h.html#a4e16de36d36af6c715d52a045f88e78" title="Optimize the profiled deviance of an lmer object or the Laplace approximation to..." alt="" coords="453,56,563,83"><area shape="rect" href="lmer_8h.html#6c02b5f73d659d2d748852fac7e9c462" title="Externally callable update_RX." alt="" coords="447,5,569,32"><area shape="rect" href="lmer_8h.html#b72ec91b1f901b466f29a80bcc22e6c4" title="Externally callable update_u." alt="" coords="283,107,397,133"></map>
</div>

</div>
</div><p>
<a class="anchor" name="119582eec2ad35c9d9516dcb3a927750"></a><!-- doxytag: member="lmer.c::chkDims" ref="119582eec2ad35c9d9516dcb3a927750" args="(char *buf, int nb, SEXP x, SEXP sym, int nr, int nc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int chkDims           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Check that slot sym of object x is a numeric matrix of dimension nr by nc. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>character buffer of length nb + 1 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nb</em>&nbsp;</td><td>number of writable positions in the buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>pointer to an mer object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sym</em>&nbsp;</td><td>name (symbol, actually) of the slot to check </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nr</em>&nbsp;</td><td>expected number of rows </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nc</em>&nbsp;</td><td>expected number of columns</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 for success, number of characters written to buf on failure </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l01704">1704</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>References <a class="el" href="lmer_8c-source.html#l00016">_</a>, and <a class="el" href="lmer_8c-source.html#l01688">BUF_SIZE</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01745">mer_validate()</a>.</p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_119582eec2ad35c9d9516dcb3a927750_icgraph.png" border="0" usemap="#lmer_8c_119582eec2ad35c9d9516dcb3a927750_icgraph_map" alt=""></center>
<map name="lmer_8c_119582eec2ad35c9d9516dcb3a927750_icgraph_map">
<area shape="rect" href="lmer_8h.html#489500e3d5104fc320a54d85c43bcfed" title="Check validity of an object that inherits from the mer class." alt="" coords="132,5,236,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="617426914114d8f8cd8249de16ddc8e1"></a><!-- doxytag: member="lmer.c::chkLen" ref="617426914114d8f8cd8249de16ddc8e1" args="(char *buf, int nb, SEXP x, SEXP sym, int len, int zerok)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int chkLen           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>zerok</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Check that the length of the sym slot in x is len or, possibly, zero. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>character buffer of length nb + 1 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nb</em>&nbsp;</td><td>number of writable positions in the buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>pointer to an mer object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sym</em>&nbsp;</td><td>name (symbol, actually) of the slot to check </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>expected length </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>zerok</em>&nbsp;</td><td>is a length of zero allowed?</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 for success, number of characters written to buf on failure </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l01727">1727</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>References <a class="el" href="lmer_8c-source.html#l00016">_</a>, and <a class="el" href="lmer_8c-source.html#l01688">BUF_SIZE</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01745">mer_validate()</a>.</p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_617426914114d8f8cd8249de16ddc8e1_icgraph.png" border="0" usemap="#lmer_8c_617426914114d8f8cd8249de16ddc8e1_icgraph_map" alt=""></center>
<map name="lmer_8c_617426914114d8f8cd8249de16ddc8e1_icgraph_map">
<area shape="rect" href="lmer_8h.html#489500e3d5104fc320a54d85c43bcfed" title="Check validity of an object that inherits from the mer class." alt="" coords="121,5,225,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="0b9684f5bbd166540f692843a07c0604"></a><!-- doxytag: member="lmer.c::get_sigma" ref="0b9684f5bbd166540f692843a07c0604" args="(int REML, const int *dims, const double *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static R_INLINE double get_sigma           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>REML</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&nbsp;</td>
          <td class="paramname"> <em>dims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>d</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the REML or ML conditional estimate of sigma, the standard deviation of the per-observation noise term. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>REML</em>&nbsp;</td><td>non-zero for REML estimate, 0 for ML estimate </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dims</em>&nbsp;</td><td>vector of dimensions </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>d</em>&nbsp;</td><td>vector of deviance components </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00169">169</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>References <a class="el" href="lmer_8c-source.html#l00052">n_POS</a>, <a class="el" href="lmer_8c-source.html#l00053">p_POS</a>, <a class="el" href="lmer_8c-source.html#l00044">pwrss_POS</a>, and <a class="el" href="lmer_8c-source.html#l00062">useSc_POS</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l00500">mer_postVar()</a>, and <a class="el" href="lmer_8c-source.html#l00484">mer_sigma()</a>.</p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_0b9684f5bbd166540f692843a07c0604_icgraph.png" border="0" usemap="#lmer_8c_0b9684f5bbd166540f692843a07c0604_icgraph_map" alt=""></center>
<map name="lmer_8c_0b9684f5bbd166540f692843a07c0604_icgraph_map">
<area shape="rect" href="lmer_8h.html#79178d4c0ab3956a7f5d5ac93416759a" title="Extract the posterior variances of the random effects in an mer object." alt="" coords="141,5,245,32"><area shape="rect" href="lmer_8h.html#1c7078c50d8111387e40b202e2e94506" title="Extract the estimate of the common scale parameter from an mer object." alt="" coords="147,56,240,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="3f49a530ee30ef0d40ef8bc6d60c5963"></a><!-- doxytag: member="lmer.c::Gp_grp" ref="3f49a530ee30ef0d40ef8bc6d60c5963" args="(int ind, int nf, const int *Gp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static R_INLINE int Gp_grp           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&nbsp;</td>
          <td class="paramname"> <em>Gp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the group in the (nf, Gp) combination to which ind belongs. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ind</em>&nbsp;</td><td>a row number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nf</em>&nbsp;</td><td>number of groups of rows </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Gp</em>&nbsp;</td><td>group pointers </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00133">133</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>References <a class="el" href="lmer_8c-source.html#l00016">_</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l00391">ST_setPars()</a>.</p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_3f49a530ee30ef0d40ef8bc6d60c5963_icgraph.png" border="0" usemap="#lmer_8c_3f49a530ee30ef0d40ef8bc6d60c5963_icgraph_map" alt=""></center>
<map name="lmer_8c_3f49a530ee30ef0d40ef8bc6d60c5963_icgraph_map">
<area shape="rect" href="lmer_8c.html#c91a1d6467c5dd44cbc4c785f643e315" title="Update the ST and C slots of an mer object." alt="" coords="123,31,216,57"><area shape="rect" href="lmer_8h.html#a4e16de36d36af6c715d52a045f88e78" title="Optimize the profiled deviance of an lmer object or the Laplace approximation to..." alt="" coords="273,5,383,32"><area shape="rect" href="lmer_8h.html#96765a284e1652326a22d50f7d7538d4" title="Update the ST slot of an mer object from a REAL vector of parameters and update the..." alt="" coords="265,56,391,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="2f1d1f23db416c858fe8eecd2bb35236"></a><!-- doxytag: member="lmer.c::lme4_devResid" ref="2f1d1f23db416c858fe8eecd2bb35236" args="(const double *mu, const double *pWt, const double *y, int n, int vTyp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static double lme4_devResid           </td>
          <td>(</td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>mu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>pWt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>vTyp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00685">685</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>References <a class="el" href="lmer_8c-source.html#l00016">_</a>, and <a class="el" href="lmer_8c-source.html#l00679">y_log_y()</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01074">mer_update_dev()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_2f1d1f23db416c858fe8eecd2bb35236_cgraph.png" border="0" usemap="#lmer_8c_2f1d1f23db416c858fe8eecd2bb35236_cgraph_map" alt=""></center>
<map name="lmer_8c_2f1d1f23db416c858fe8eecd2bb35236_cgraph_map">
<area shape="rect" href="lmer_8c.html#5023a36a5ff0bec88db074b701eaf563" title="Evaluate y * log(y/mu) with the correct limiting value at y = 0." alt="" coords="173,5,243,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_2f1d1f23db416c858fe8eecd2bb35236_icgraph.png" border="0" usemap="#lmer_8c_2f1d1f23db416c858fe8eecd2bb35236_icgraph_map" alt=""></center>
<map name="lmer_8c_2f1d1f23db416c858fe8eecd2bb35236_icgraph_map">
<area shape="rect" href="lmer_8h.html#c33b16395fa975458685d0eb76996f92" title="Evaluate the discrepancy and log of the penalized discrepancy." alt="" coords="173,5,304,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="4a0a18cf109ccc29a71a27a7f12bf4a7"></a><!-- doxytag: member="lmer.c::lme4_muEta" ref="4a0a18cf109ccc29a71a27a7f12bf4a7" args="(double *mu, double *muEta, const double *eta, int n, int typ)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void lme4_muEta           </td>
          <td>(</td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>mu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>muEta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>eta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>typ</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00588">588</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>References <a class="el" href="lmer_8c-source.html#l00016">_</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l00725">update_mu()</a>.</p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_4a0a18cf109ccc29a71a27a7f12bf4a7_icgraph.png" border="0" usemap="#lmer_8c_4a0a18cf109ccc29a71a27a7f12bf4a7_icgraph_map" alt=""></center>
<map name="lmer_8c_4a0a18cf109ccc29a71a27a7f12bf4a7_icgraph_map">
<area shape="rect" href="lmer_8c.html#da558f58458c36a96585a9c6e695a0b6" title="Update the eta, v, mu, resid and var slots according to the current values of the..." alt="" coords="159,31,252,57"><area shape="rect" href="lmer_8h.html#64740a858f90763461cbccea9c787b6b" title="Externally callable update_mu." alt="" coords="301,5,429,32"><area shape="rect" href="lmer_8c.html#88236137756e85a656de3402adcf4747" title="Iterate to determine the conditional modes of the random effects." alt="" coords="325,56,405,83"><area shape="rect" href="lmer_8h.html#a4e16de36d36af6c715d52a045f88e78" title="Optimize the profiled deviance of an lmer object or the Laplace approximation to..." alt="" coords="480,31,589,57"><area shape="rect" href="lmer_8h.html#b72ec91b1f901b466f29a80bcc22e6c4" title="Externally callable update_u." alt="" coords="477,81,592,108"></map>
</div>

</div>
</div><p>
<a class="anchor" name="3e5fbf4c0511166682d134b8b4c68502"></a><!-- doxytag: member="lmer.c::lme4_rWishart" ref="3e5fbf4c0511166682d134b8b4c68502" args="(SEXP ns, SEXP dfp, SEXP scal)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP lme4_rWishart           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>dfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>scal</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Simulate a sample of random matrices from a Wishart distribution. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ns</em>&nbsp;</td><td>Number of samples to generate </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dfp</em>&nbsp;</td><td>Degrees of freedom </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>scal</em>&nbsp;</td><td>Positive-definite scale matrix</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd></dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l01428">1428</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="a5f4cdbae42bcf865082dea1ebe09357"></a><!-- doxytag: member="lmer.c::lme4_varFunc" ref="a5f4cdbae42bcf865082dea1ebe09357" args="(double *var, const double *mu, int n, int vTyp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void lme4_varFunc           </td>
          <td>(</td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>mu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>vTyp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00636">636</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>References <a class="el" href="lmer_8c-source.html#l00016">_</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l00725">update_mu()</a>.</p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_a5f4cdbae42bcf865082dea1ebe09357_icgraph.png" border="0" usemap="#lmer_8c_a5f4cdbae42bcf865082dea1ebe09357_icgraph_map" alt=""></center>
<map name="lmer_8c_a5f4cdbae42bcf865082dea1ebe09357_icgraph_map">
<area shape="rect" href="lmer_8c.html#da558f58458c36a96585a9c6e695a0b6" title="Update the eta, v, mu, resid and var slots according to the current values of the..." alt="" coords="167,31,260,57"><area shape="rect" href="lmer_8h.html#64740a858f90763461cbccea9c787b6b" title="Externally callable update_mu." alt="" coords="309,5,437,32"><area shape="rect" href="lmer_8c.html#88236137756e85a656de3402adcf4747" title="Iterate to determine the conditional modes of the random effects." alt="" coords="333,56,413,83"><area shape="rect" href="lmer_8h.html#a4e16de36d36af6c715d52a045f88e78" title="Optimize the profiled deviance of an lmer object or the Laplace approximation to..." alt="" coords="488,31,597,57"><area shape="rect" href="lmer_8h.html#b72ec91b1f901b466f29a80bcc22e6c4" title="Externally callable update_u." alt="" coords="485,81,600,108"></map>
</div>

</div>
</div><p>
<a class="anchor" name="f1bc9174690e2956720aa31781b073f0"></a><!-- doxytag: member="lmer.c::MCMC_beta" ref="f1bc9174690e2956720aa31781b073f0" args="(SEXP x, double sigma)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void MCMC_beta           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>sigma</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Update the fixed effects in an MCMC sample from an mer object. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>an lmer model with mer_update_b </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sigma</em>&nbsp;</td><td>current standard deviation of the per-observation noise terms. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l01479">1479</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>References <a class="el" href="lmer_8c-source.html#l00033">Alloca</a>, <a class="el" href="init_8c-source.html#l00034">c</a>, <a class="el" href="lmer_8c-source.html#l00070">L_SLOT</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_fixefSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_RCXySym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_RXySym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_uSym</a>, and <a class="el" href="lmer_8c-source.html#l00253">update_ranef()</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01633">mer_MCMCsamp()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_f1bc9174690e2956720aa31781b073f0_cgraph.png" border="0" usemap="#lmer_8c_f1bc9174690e2956720aa31781b073f0_cgraph_map" alt=""></center>
<map name="lmer_8c_f1bc9174690e2956720aa31781b073f0_cgraph_map">
<area shape="rect" href="lmer_8c.html#5542c4de7dbcdbb6630cad8fabe96542" title="Update the contents of the ranef slot in an mer object." alt="" coords="159,56,265,83"><area shape="rect" href="lmer_8c.html#0a84fce1f01d522d8c5379001e23bc8c" title="Extract the slot named nm from the object obj and return a null pointer if the slot..." alt="" coords="316,5,457,32"><area shape="rect" href="lmer_8c.html#c96e3dd08e67f41338d9e84118925308" title="Return the sum of squares of the first n elements of x." alt="" coords="343,56,431,83"><area shape="rect" href="lmer_8c.html#3a7fab2a88117d83971db12f53eaa91e" title="Populate the st, nc and nlev arrays." alt="" coords="341,107,432,133"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_f1bc9174690e2956720aa31781b073f0_icgraph.png" border="0" usemap="#lmer_8c_f1bc9174690e2956720aa31781b073f0_icgraph_map" alt=""></center>
<map name="lmer_8c_f1bc9174690e2956720aa31781b073f0_icgraph_map">
<area shape="rect" href="lmer_8h.html#edec83b72f0c3437d9b10daf5120aa2b" title="Generate a Markov&#45;chain Monte Carlo sample from an mer object." alt="" coords="157,5,293,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="c8a525d9fe2317c0b658051821bdc754"></a><!-- doxytag: member="lmer.c::MCMC_sigma" ref="c8a525d9fe2317c0b658051821bdc754" args="(const int *dims, const double *d)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static R_INLINE double MCMC_sigma           </td>
          <td>(</td>
          <td class="paramtype">const int *&nbsp;</td>
          <td class="paramname"> <em>dims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>d</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Generate a new value of sigma, the common scale parameter, for an mer object. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dims</em>&nbsp;</td><td>dims slot of the mer object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>d</em>&nbsp;</td><td>deviance slot of the mer object</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>an updated sigma </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l01616">1616</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>References <a class="el" href="lmer_8c-source.html#l00044">pwrss_POS</a>, <a class="el" href="lmer_8c-source.html#l00067">RDF</a>, and <a class="el" href="lmer_8c-source.html#l00062">useSc_POS</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01633">mer_MCMCsamp()</a>.</p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_c8a525d9fe2317c0b658051821bdc754_icgraph.png" border="0" usemap="#lmer_8c_c8a525d9fe2317c0b658051821bdc754_icgraph_map" alt=""></center>
<map name="lmer_8c_c8a525d9fe2317c0b658051821bdc754_icgraph_map">
<area shape="rect" href="lmer_8h.html#edec83b72f0c3437d9b10daf5120aa2b" title="Generate a Markov&#45;chain Monte Carlo sample from an mer object." alt="" coords="165,5,301,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="ef128b4cee2e476298b3b4388d8a2097"></a><!-- doxytag: member="lmer.c::MCMC_ST" ref="ef128b4cee2e476298b3b4388d8a2097" args="(SEXP x, double sigma, double *vals, int trans)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void MCMC_ST           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>trans</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l01538">1538</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>References <a class="el" href="lmer_8c-source.html#l00016">_</a>, <a class="el" href="lmer_8c-source.html#l00033">Alloca</a>, <a class="el" href="lmer_8c-source.html#l00036">AZERO</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_GpSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_ranefSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_STSym</a>, <a class="el" href="lmer_8c-source.html#l01521">safe_pd_matrix()</a>, <a class="el" href="lmer_8c-source.html#l00190">ST_nc_nlev()</a>, and <a class="el" href="lmer_8c-source.html#l01400">std_rWishart_factor()</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01633">mer_MCMCsamp()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_ef128b4cee2e476298b3b4388d8a2097_cgraph.png" border="0" usemap="#lmer_8c_ef128b4cee2e476298b3b4388d8a2097_cgraph_map" alt=""></center>
<map name="lmer_8c_ef128b4cee2e476298b3b4388d8a2097_cgraph_map">
<area shape="rect" href="lmer_8c.html#24e3fc6b91cae668ea046c4b5e5ff9ed" title="safe_pd_matrix" alt="" coords="157,5,277,32"><area shape="rect" href="lmer_8c.html#3a7fab2a88117d83971db12f53eaa91e" title="Populate the st, nc and nlev arrays." alt="" coords="172,56,263,83"><area shape="rect" href="lmer_8c.html#9812644aac7804e273e0a48e138eb9f9" title="Simulate the Cholesky factor of a standardized Wishart variate with dimension p and..." alt="" coords="144,107,291,133"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_ef128b4cee2e476298b3b4388d8a2097_icgraph.png" border="0" usemap="#lmer_8c_ef128b4cee2e476298b3b4388d8a2097_icgraph_map" alt=""></center>
<map name="lmer_8c_ef128b4cee2e476298b3b4388d8a2097_icgraph_map">
<area shape="rect" href="lmer_8h.html#edec83b72f0c3437d9b10daf5120aa2b" title="Generate a Markov&#45;chain Monte Carlo sample from an mer object." alt="" coords="144,5,280,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="0903b0858c61e7e394c4dfb5f2661748"></a><!-- doxytag: member="lmer.c::MCMC_u" ref="0903b0858c61e7e394c4dfb5f2661748" args="(SEXP x, double sigma)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void MCMC_u           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>sigma</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Update the orthogonal random effects in an MCMC sample from an mer object. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>an lmer model with mer_update_b </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sigma</em>&nbsp;</td><td>current standard deviation of the per-observation noise terms. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l01516">1516</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01633">mer_MCMCsamp()</a>.</p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_0903b0858c61e7e394c4dfb5f2661748_icgraph.png" border="0" usemap="#lmer_8c_0903b0858c61e7e394c4dfb5f2661748_icgraph_map" alt=""></center>
<map name="lmer_8c_0903b0858c61e7e394c4dfb5f2661748_icgraph_map">
<area shape="rect" href="lmer_8h.html#edec83b72f0c3437d9b10daf5120aa2b" title="Generate a Markov&#45;chain Monte Carlo sample from an mer object." alt="" coords="136,5,272,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="f0bf2e6ee95fd84db9323208711ae3bc"></a><!-- doxytag: member="lmer.c::mer_create_L" ref="f0bf2e6ee95fd84db9323208711ae3bc" args="(SEXP CmP)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP mer_create_L           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>CmP</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create and initialize L. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>CmP</em>&nbsp;</td><td>pointer to the model matrix for the orthogonal random effects (transposed)</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>L </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00563">563</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="8f6debb5f78c3602ed0d576add360e68"></a><!-- doxytag: member="lmer.c::mer_MCMCsamp" ref="8f6debb5f78c3602ed0d576add360e68" args="(SEXP x, SEXP savebp, SEXP nsampp, SEXP transp, SEXP verbosep, SEXP deviancep)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP mer_MCMCsamp           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>savebp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>nsampp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>transp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>verbosep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>deviancep</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Generate a Markov-chain Monte Carlo sample from an mer object. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>pointer to an lmer object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>savebp</em>&nbsp;</td><td>logical scalar - save random effects? </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nsampp</em>&nbsp;</td><td>integer scalar - number of samples to generate </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>transp</em>&nbsp;</td><td>logical scalar - transform variance components? </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>verbosep</em>&nbsp;</td><td>logical scalar - verbose output? </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>deviancep</em>&nbsp;</td><td>logical scalar - store the deviance?</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>a matrix </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l01633">1633</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="7aa21aea1da63a3096fcc054cc6c9dd5"></a><!-- doxytag: member="lmer.c::mer_optimize" ref="7aa21aea1da63a3096fcc054cc6c9dd5" args="(SEXP x, SEXP verbp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP mer_optimize           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>verbp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Optimize the profiled deviance of an lmer object or the Laplace approximation to the deviance of a nlmer or glmer object. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>pointer to an mer object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>verbp</em>&nbsp;</td><td>pointer to indicator of verbose output</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>R_NilValue </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l01319">1319</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="79178d4c0ab3956a7f5d5ac93416759a"></a><!-- doxytag: member="lmer.c::mer_postVar" ref="79178d4c0ab3956a7f5d5ac93416759a" args="(SEXP x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP mer_postVar           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Extract the posterior variances of the random effects in an mer object. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>pointer to an mer object</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>pointer to a list of arrays </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00500">500</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="1c7078c50d8111387e40b202e2e94506"></a><!-- doxytag: member="lmer.c::mer_sigma" ref="1c7078c50d8111387e40b202e2e94506" args="(SEXP x, SEXP which)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP mer_sigma           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>which</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Extract the estimate of the common scale parameter from an mer object. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>an lmer object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>which</em>&nbsp;</td><td>scalar integer (&lt; 0 =&gt; REML, 0 =&gt; native, &gt; 0 =&gt; ML)</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>scalar REAL value </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00484">484</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="1f6b9123d7b4dcbe24cc9085e5f4069a"></a><!-- doxytag: member="lmer.c::mer_ST_getPars" ref="1f6b9123d7b4dcbe24cc9085e5f4069a" args="(SEXP x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP mer_ST_getPars           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Extract the parameters from the ST slot of an mer object. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>an mer object</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>pointer to a REAL vector </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00373">373</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01633">mer_MCMCsamp()</a>.</p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_1f6b9123d7b4dcbe24cc9085e5f4069a_icgraph.png" border="0" usemap="#lmer_8c_1f6b9123d7b4dcbe24cc9085e5f4069a_icgraph_map" alt=""></center>
<map name="lmer_8c_1f6b9123d7b4dcbe24cc9085e5f4069a_icgraph_map">
<area shape="rect" href="lmer_8h.html#edec83b72f0c3437d9b10daf5120aa2b" title="Generate a Markov&#45;chain Monte Carlo sample from an mer object." alt="" coords="181,5,317,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="0a12a0220833deaf108e01ca3ecaac51"></a><!-- doxytag: member="lmer.c::mer_ST_initialize" ref="0a12a0220833deaf108e01ca3ecaac51" args="(SEXP ST, SEXP Gpp, SEXP Zt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP mer_ST_initialize           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>ST</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>Gpp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>Zt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Evaluate starting estimates for the elements of ST. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ST</em>&nbsp;</td><td>pointers to the nf ST factorizations of the diagonal elements of Sigma </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Gpp</em>&nbsp;</td><td>length nf+1 vector of group pointers for the rows of Zt </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Zt</em>&nbsp;</td><td>transpose of Z matrix </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00311">311</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="96765a284e1652326a22d50f7d7538d4"></a><!-- doxytag: member="lmer.c::mer_ST_setPars" ref="96765a284e1652326a22d50f7d7538d4" args="(SEXP x, SEXP pars)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP mer_ST_setPars           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>pars</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Update the ST slot of an mer object from a REAL vector of parameters and update the Cholesky factorization. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>an mer object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pars</em>&nbsp;</td><td>a REAL vector of the appropriate length</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>R_NilValue </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00466">466</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01633">mer_MCMCsamp()</a>.</p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_96765a284e1652326a22d50f7d7538d4_icgraph.png" border="0" usemap="#lmer_8c_96765a284e1652326a22d50f7d7538d4_icgraph_map" alt=""></center>
<map name="lmer_8c_96765a284e1652326a22d50f7d7538d4_icgraph_map">
<area shape="rect" href="lmer_8h.html#edec83b72f0c3437d9b10daf5120aa2b" title="Generate a Markov&#45;chain Monte Carlo sample from an mer object." alt="" coords="181,5,317,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="c33b16395fa975458685d0eb76996f92"></a><!-- doxytag: member="lmer.c::mer_update_dev" ref="c33b16395fa975458685d0eb76996f92" args="(SEXP x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP mer_update_dev           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Evaluate the discrepancy and log of the penalized discrepancy. 
<p>
update_mu must be called first.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>pointer to an mer object </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l01074">1074</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01319">mer_optimize()</a>.</p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_c33b16395fa975458685d0eb76996f92_icgraph.png" border="0" usemap="#lmer_8c_c33b16395fa975458685d0eb76996f92_icgraph_map" alt=""></center>
<map name="lmer_8c_c33b16395fa975458685d0eb76996f92_icgraph_map">
<area shape="rect" href="lmer_8h.html#a4e16de36d36af6c715d52a045f88e78" title="Optimize the profiled deviance of an lmer object or the Laplace approximation to..." alt="" coords="184,5,293,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="f61a89a1f6aa003a5ae87d08cb8c9af7"></a><!-- doxytag: member="lmer.c::mer_update_L" ref="f61a89a1f6aa003a5ae87d08cb8c9af7" args="(SEXP x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP mer_update_L           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Externally callable update_L. 
<p>
Update the A, L, sqrtrWt and resid slots. It is assumed that update_mu has already been called at the current values of u and the model parameters.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>an mer object</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>penalized weighted residual sum of squares </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00951">951</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="64740a858f90763461cbccea9c787b6b"></a><!-- doxytag: member="lmer.c::mer_update_mu" ref="64740a858f90763461cbccea9c787b6b" args="(SEXP x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP mer_update_mu           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Externally callable update_mu. 
<p>
Update the eta, v, mu, resid and var slots according to the current values of the parameters and u. Also evaluate d[wrss_POS] using the current contents of sqrtrWt. The sqrtrWt slot is updated in update_L.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>pointer to an mer object</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>penalized, weighted residual sum of squares </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00827">827</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="bc080c9abeb9965118c6d114d6df1cb3"></a><!-- doxytag: member="lmer.c::mer_update_ranef" ref="bc080c9abeb9965118c6d114d6df1cb3" args="(SEXP x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP mer_update_ranef           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Externally callable update_ranef. 
<p>
Update the contents of the ranef slot in an mer object. For a linear mixed model the conditional estimates of the fixed effects and the conditional mode of u are evaluated first.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>an mer object</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>R_NilValue </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l01099">1099</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="6c02b5f73d659d2d748852fac7e9c462"></a><!-- doxytag: member="lmer.c::mer_update_RX" ref="6c02b5f73d659d2d748852fac7e9c462" args="(SEXP x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP mer_update_RX           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Externally callable update_RX. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>pointer to an mer object</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>profiled deviance or REML deviance </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l01304">1304</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="b72ec91b1f901b466f29a80bcc22e6c4"></a><!-- doxytag: member="lmer.c::mer_update_u" ref="b72ec91b1f901b466f29a80bcc22e6c4" args="(SEXP x, SEXP verbP)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP mer_update_u           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>verbP</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Externally callable update_u. 
<p>
Iterate to determine the conditional modes of the random effects.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>pointer to an mer object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>verbP</em>&nbsp;</td><td>scalar integer indicator of verbose output (negative values produce a lot of output)</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>number of iterations to convergence (0 for non-convergence) </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l01056">1056</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="489500e3d5104fc320a54d85c43bcfed"></a><!-- doxytag: member="lmer.c::mer_validate" ref="489500e3d5104fc320a54d85c43bcfed" args="(SEXP x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP mer_validate           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Check validity of an object that inherits from the mer class. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>Pointer to an lmer or glmer or nlmer object</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>TRUE if the object is a valid mer object, otherwise a string that describes the violation. </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l01745">1745</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="d562658adcecf9b4a01944b227be5915"></a><!-- doxytag: member="lmer.c::P_sdmult" ref="d562658adcecf9b4a01944b227be5915" args="(double *dest, const int *perm, const CHM_SP A, const double *X, int nc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void P_sdmult           </td>
          <td>(</td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&nbsp;</td>
          <td class="paramname"> <em>perm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const CHM_SP&nbsp;</td>
          <td class="paramname"> <em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create PAX in dest. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dest</em>&nbsp;</td><td>values to be calculated </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>perm</em>&nbsp;</td><td>NULL or a 0-based permutation vector defining P </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>A</em>&nbsp;</td><td>sparse matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>X</em>&nbsp;</td><td>dense matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nc</em>&nbsp;</td><td>number of columns in X </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l01181">1181</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>References <a class="el" href="lmer_8c-source.html#l00033">Alloca</a>, <a class="el" href="lmer_8c-source.html#l00100">apply_perm()</a>, and <a class="el" href="lmer_8c-source.html#l00036">AZERO</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01206">update_RX()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_d562658adcecf9b4a01944b227be5915_cgraph.png" border="0" usemap="#lmer_8c_d562658adcecf9b4a01944b227be5915_cgraph_map" alt=""></center>
<map name="lmer_8c_d562658adcecf9b4a01944b227be5915_cgraph_map">
<area shape="rect" href="lmer_8c.html#c6c092e8b91bd83d19519bdc69bf6801" title="Permute the vector src according to perm into dest." alt="" coords="137,5,233,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_d562658adcecf9b4a01944b227be5915_icgraph.png" border="0" usemap="#lmer_8c_d562658adcecf9b4a01944b227be5915_icgraph_map" alt=""></center>
<map name="lmer_8c_d562658adcecf9b4a01944b227be5915_icgraph_map">
<area shape="rect" href="lmer_8c.html#2c7f7874e2eb3f6c51c53c5873cffec4" title="Update the RCX and RX slots in an mer object." alt="" coords="136,31,227,57"><area shape="rect" href="lmer_8h.html#a4e16de36d36af6c715d52a045f88e78" title="Optimize the profiled deviance of an lmer object or the Laplace approximation to..." alt="" coords="283,5,392,32"><area shape="rect" href="lmer_8h.html#6c02b5f73d659d2d748852fac7e9c462" title="Externally callable update_RX." alt="" coords="276,56,399,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="06b081a8a5b894d99de0539549058b15"></a><!-- doxytag: member="lmer.c::pedigree_chol" ref="06b081a8a5b894d99de0539549058b15" args="(SEXP x, SEXP ans)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP pedigree_chol           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>ans</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create the left Cholesky factor of the numerator relationship matrix from a pedigree. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>a pedigree object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ans</em>&nbsp;</td><td>T stored as a non-unit, lower dtCMatrix</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>ans with elements modified to incorporate D </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l01826">1826</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="717631a5aed4d47229922c84b9b1a952"></a><!-- doxytag: member="lmer.c::pedigree_inbreeding" ref="717631a5aed4d47229922c84b9b1a952" args="(SEXP x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP pedigree_inbreeding           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create the inbreeding coefficients according to the algorithm given in "Comparison of four direct algorithms for computing inbreeding coefficients" by Mehdi Sargolzaei and Hiroaki Iwaisaki, Animal Science Journal (2005) 76, 401--406. 
<p>
This function is a modified version of the code published in an appendix to that paper.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>a pedigree object</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>a list of the inbreeding coefficients </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l01881">1881</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>References <a class="el" href="lmer_8c-source.html#l00033">Alloca</a>.</p>

</div>
</div><p>
<a class="anchor" name="24e3fc6b91cae668ea046c4b5e5ff9ed"></a><!-- doxytag: member="lmer.c::safe_pd_matrix" ref="24e3fc6b91cae668ea046c4b5e5ff9ed" args="(double x[], const char uplo[], int n, double thresh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void safe_pd_matrix           </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&nbsp;</td>
          <td class="paramname"> <em>uplo</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>thresh</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l01521">1521</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>References <a class="el" href="lmer_8c-source.html#l00016">_</a>, and <a class="el" href="lmer_8c-source.html#l00033">Alloca</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01538">MCMC_ST()</a>.</p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_24e3fc6b91cae668ea046c4b5e5ff9ed_icgraph.png" border="0" usemap="#lmer_8c_24e3fc6b91cae668ea046c4b5e5ff9ed_icgraph_map" alt=""></center>
<map name="lmer_8c_24e3fc6b91cae668ea046c4b5e5ff9ed_icgraph_map">
<area shape="rect" href="lmer_8c.html#ef128b4cee2e476298b3b4388d8a2097" title="MCMC_ST" alt="" coords="177,5,265,32"><area shape="rect" href="lmer_8h.html#edec83b72f0c3437d9b10daf5120aa2b" title="Generate a Markov&#45;chain Monte Carlo sample from an mer object." alt="" coords="315,5,451,32"></map>
</div>

</div>
</div><p>
<a class="anchor" name="0a84fce1f01d522d8c5379001e23bc8c"></a><!-- doxytag: member="lmer.c::SLOT_REAL_NULL" ref="0a84fce1f01d522d8c5379001e23bc8c" args="(SEXP obj, SEXP nm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static R_INLINE double* SLOT_REAL_NULL           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>nm</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Extract the slot named nm from the object obj and return a null pointer if the slot has length 0 or a pointer to the REAL contents. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>obj</em>&nbsp;</td><td>pointer to an S4 object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nm</em>&nbsp;</td><td>pointer to a symbol naming the slot to extract</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>pointer to the REAL contents, if nonzero length, otherwise a NULL pointer </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00151">151</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01074">mer_update_dev()</a>, <a class="el" href="lmer_8c-source.html#l00842">update_L()</a>, <a class="el" href="lmer_8c-source.html#l00725">update_mu()</a>, <a class="el" href="lmer_8c-source.html#l00253">update_ranef()</a>, <a class="el" href="lmer_8c-source.html#l01206">update_RX()</a>, and <a class="el" href="lmer_8c-source.html#l00972">update_u()</a>.</p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_0a84fce1f01d522d8c5379001e23bc8c_icgraph.png" border="0" usemap="#lmer_8c_0a84fce1f01d522d8c5379001e23bc8c_icgraph_map" alt=""></center>
<map name="lmer_8c_0a84fce1f01d522d8c5379001e23bc8c_icgraph_map">
<area shape="rect" href="lmer_8h.html#c33b16395fa975458685d0eb76996f92" title="Evaluate the discrepancy and log of the penalized discrepancy." alt="" coords="197,16,328,43"><area shape="rect" href="lmer_8c.html#2f257f628f06920b351486d48ab50026" title="Update the A, L, sqrtrWt and resid slots." alt="" coords="223,143,303,169"><area shape="rect" href="lmer_8c.html#88236137756e85a656de3402adcf4747" title="Iterate to determine the conditional modes of the random effects." alt="" coords="407,193,487,220"><area shape="rect" href="lmer_8c.html#da558f58458c36a96585a9c6e695a0b6" title="Update the eta, v, mu, resid and var slots according to the current values of the..." alt="" coords="216,244,309,271"><area shape="rect" href="lmer_8c.html#5542c4de7dbcdbb6630cad8fabe96542" title="Update the contents of the ranef slot in an mer object." alt="" coords="209,320,316,347"><area shape="rect" href="lmer_8c.html#2c7f7874e2eb3f6c51c53c5873cffec4" title="Update the RCX and RX slots in an mer object." alt="" coords="217,67,308,93"><area shape="rect" href="lmer_8h.html#a4e16de36d36af6c715d52a045f88e78" title="Optimize the profiled deviance of an lmer object or the Laplace approximation to..." alt="" coords="579,143,688,169"><area shape="rect" href="lmer_8h.html#f61a89a1f6aa003a5ae87d08cb8c9af7" title="Externally callable update_L." alt="" coords="389,92,504,119"><area shape="rect" href="lmer_8h.html#b72ec91b1f901b466f29a80bcc22e6c4" title="Externally callable update_u." alt="" coords="576,193,691,220"><area shape="rect" href="lmer_8h.html#64740a858f90763461cbccea9c787b6b" title="Externally callable update_mu." alt="" coords="383,244,511,271"><area shape="rect" href="lmer_8c.html#f1bc9174690e2956720aa31781b073f0" title="Update the fixed effects in an MCMC sample from an mer object." alt="" coords="396,295,497,321"><area shape="rect" href="lmer_8h.html#edec83b72f0c3437d9b10daf5120aa2b" title="Generate a Markov&#45;chain Monte Carlo sample from an mer object." alt="" coords="565,320,701,347"><area shape="rect" href="lmer_8h.html#bc080c9abeb9965118c6d114d6df1cb3" title="Externally callable update_ranef." alt="" coords="376,396,517,423"><area shape="rect" href="lmer_8h.html#6c02b5f73d659d2d748852fac7e9c462" title="Externally callable update_RX." alt="" coords="385,41,508,68"></map>
</div>

</div>
</div><p>
<a class="anchor" name="c96e3dd08e67f41338d9e84118925308"></a><!-- doxytag: member="lmer.c::sqr_length" ref="c96e3dd08e67f41338d9e84118925308" args="(const double *x, int n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static R_INLINE double sqr_length           </td>
          <td>(</td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the sum of squares of the first n elements of x. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>n</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>sum of squares </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00080">80</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l00725">update_mu()</a>, <a class="el" href="lmer_8c-source.html#l00253">update_ranef()</a>, <a class="el" href="lmer_8c-source.html#l01206">update_RX()</a>, and <a class="el" href="lmer_8c-source.html#l00972">update_u()</a>.</p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_c96e3dd08e67f41338d9e84118925308_icgraph.png" border="0" usemap="#lmer_8c_c96e3dd08e67f41338d9e84118925308_icgraph_map" alt=""></center>
<map name="lmer_8c_c96e3dd08e67f41338d9e84118925308_icgraph_map">
<area shape="rect" href="lmer_8c.html#da558f58458c36a96585a9c6e695a0b6" title="Update the eta, v, mu, resid and var slots according to the current values of the..." alt="" coords="149,135,243,161"><area shape="rect" href="lmer_8c.html#88236137756e85a656de3402adcf4747" title="Iterate to determine the conditional modes of the random effects." alt="" coords="329,185,409,212"><area shape="rect" href="lmer_8c.html#5542c4de7dbcdbb6630cad8fabe96542" title="Update the contents of the ranef slot in an mer object." alt="" coords="143,59,249,85"><area shape="rect" href="lmer_8c.html#2c7f7874e2eb3f6c51c53c5873cffec4" title="Update the RCX and RX slots in an mer object." alt="" coords="151,236,241,263"><area shape="rect" href="lmer_8h.html#64740a858f90763461cbccea9c787b6b" title="Externally callable update_mu." alt="" coords="305,135,433,161"><area shape="rect" href="lmer_8h.html#a4e16de36d36af6c715d52a045f88e78" title="Optimize the profiled deviance of an lmer object or the Laplace approximation to..." alt="" coords="501,261,611,288"><area shape="rect" href="lmer_8h.html#b72ec91b1f901b466f29a80bcc22e6c4" title="Externally callable update_u." alt="" coords="499,185,613,212"><area shape="rect" href="lmer_8c.html#f1bc9174690e2956720aa31781b073f0" title="Update the fixed effects in an MCMC sample from an mer object." alt="" coords="319,84,420,111"><area shape="rect" href="lmer_8h.html#edec83b72f0c3437d9b10daf5120aa2b" title="Generate a Markov&#45;chain Monte Carlo sample from an mer object." alt="" coords="488,33,624,60"><area shape="rect" href="lmer_8h.html#bc080c9abeb9965118c6d114d6df1cb3" title="Externally callable update_ranef." alt="" coords="299,33,440,60"><area shape="rect" href="lmer_8h.html#6c02b5f73d659d2d748852fac7e9c462" title="Externally callable update_RX." alt="" coords="308,236,431,263"></map>
</div>

</div>
</div><p>
<a class="anchor" name="1d1cc0c037f6827ce66c5aa1db650224"></a><!-- doxytag: member="lmer.c::ST_getPars" ref="1d1cc0c037f6827ce66c5aa1db650224" args="(SEXP x, double *pars)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static double* ST_getPars           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>pars</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Extract the parameters from ST list. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>an mer object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pars</em>&nbsp;</td><td>vector of the appropriate length</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>pointer to the parameter vector </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00347">347</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>References <a class="el" href="Syms_8h-source.html#l00003">lme4_STSym</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01319">mer_optimize()</a>, and <a class="el" href="lmer_8c-source.html#l00373">mer_ST_getPars()</a>.</p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_1d1cc0c037f6827ce66c5aa1db650224_icgraph.png" border="0" usemap="#lmer_8c_1d1cc0c037f6827ce66c5aa1db650224_icgraph_map" alt=""></center>
<map name="lmer_8c_1d1cc0c037f6827ce66c5aa1db650224_icgraph_map">
<area shape="rect" href="lmer_8h.html#a4e16de36d36af6c715d52a045f88e78" title="Optimize the profiled deviance of an lmer object or the Laplace approximation to..." alt="" coords="159,5,268,32"><area shape="rect" href="lmer_8h.html#1f6b9123d7b4dcbe24cc9085e5f4069a" title="Extract the parameters from the ST slot of an mer object." alt="" coords="149,56,277,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="3a7fab2a88117d83971db12f53eaa91e"></a><!-- doxytag: member="lmer.c::ST_nc_nlev" ref="3a7fab2a88117d83971db12f53eaa91e" args="(const SEXP ST, const int *Gp, double **st, int *nc, int *nlev)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int ST_nc_nlev           </td>
          <td>(</td>
          <td class="paramtype">const SEXP&nbsp;</td>
          <td class="paramname"> <em>ST</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&nbsp;</td>
          <td class="paramname"> <em>Gp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&nbsp;</td>
          <td class="paramname"> <em>st</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>nc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>nlev</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Populate the st, nc and nlev arrays. 
<p>
Return the maximum element of nc.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ST</em>&nbsp;</td><td>pointer to a list (length nf) of matrices </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Gp</em>&nbsp;</td><td>group pointers (length nf + 1) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>st</em>&nbsp;</td><td>length nf array of (double*) pointers to be filled with pointers to the contents of the matrices in ST. Not used if NULL. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nc</em>&nbsp;</td><td>length nf array to be filled with the number of columns </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nlev</em>&nbsp;</td><td>length nf array to be filled with the number of levels of the grouping factor for each term</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>maximum element of nc </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00190">190</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01538">MCMC_ST()</a>, <a class="el" href="lmer_8c-source.html#l00500">mer_postVar()</a>, <a class="el" href="lmer_8c-source.html#l00311">mer_ST_initialize()</a>, <a class="el" href="lmer_8c-source.html#l00391">ST_setPars()</a>, and <a class="el" href="lmer_8c-source.html#l00253">update_ranef()</a>.</p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_3a7fab2a88117d83971db12f53eaa91e_icgraph.png" border="0" usemap="#lmer_8c_3a7fab2a88117d83971db12f53eaa91e_icgraph_map" alt=""></center>
<map name="lmer_8c_3a7fab2a88117d83971db12f53eaa91e_icgraph_map">
<area shape="rect" href="lmer_8c.html#ef128b4cee2e476298b3b4388d8a2097" title="MCMC_ST" alt="" coords="349,16,437,43"><area shape="rect" href="lmer_8h.html#79178d4c0ab3956a7f5d5ac93416759a" title="Extract the posterior variances of the random effects in an mer object." alt="" coords="159,41,263,68"><area shape="rect" href="lmer_8h.html#8559f52eaa24d57b05ded03099dbe157" title="Evaluate starting estimates for the elements of ST." alt="" coords="148,92,273,119"><area shape="rect" href="lmer_8c.html#c91a1d6467c5dd44cbc4c785f643e315" title="Update the ST and C slots of an mer object." alt="" coords="164,143,257,169"><area shape="rect" href="lmer_8c.html#5542c4de7dbcdbb6630cad8fabe96542" title="Update the contents of the ranef slot in an mer object." alt="" coords="157,219,264,245"><area shape="rect" href="lmer_8h.html#edec83b72f0c3437d9b10daf5120aa2b" title="Generate a Markov&#45;chain Monte Carlo sample from an mer object." alt="" coords="512,180,648,207"><area shape="rect" href="lmer_8h.html#a4e16de36d36af6c715d52a045f88e78" title="Optimize the profiled deviance of an lmer object or the Laplace approximation to..." alt="" coords="339,79,448,105"><area shape="rect" href="lmer_8h.html#96765a284e1652326a22d50f7d7538d4" title="Update the ST slot of an mer object from a REAL vector of parameters and update the..." alt="" coords="331,129,456,156"><area shape="rect" href="lmer_8c.html#f1bc9174690e2956720aa31781b073f0" title="Update the fixed effects in an MCMC sample from an mer object." alt="" coords="343,231,444,257"><area shape="rect" href="lmer_8h.html#bc080c9abeb9965118c6d114d6df1cb3" title="Externally callable update_ranef." alt="" coords="323,281,464,308"></map>
</div>

</div>
</div><p>
<a class="anchor" name="c91a1d6467c5dd44cbc4c785f643e315"></a><!-- doxytag: member="lmer.c::ST_setPars" ref="c91a1d6467c5dd44cbc4c785f643e315" args="(SEXP x, const double *pars)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ST_setPars           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>pars</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Update the ST and C slots of an mer object. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>an mer object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pars</em>&nbsp;</td><td>double vector of the appropriate length </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00391">391</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>References <a class="el" href="lmer_8c-source.html#l00016">_</a>, <a class="el" href="lmer_8c-source.html#l00033">Alloca</a>, <a class="el" href="lmer_8c-source.html#l00036">AZERO</a>, <a class="el" href="lmer_8c-source.html#l00133">Gp_grp()</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_ASym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_GpSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_STSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_ZtSym</a>, and <a class="el" href="lmer_8c-source.html#l00190">ST_nc_nlev()</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01319">mer_optimize()</a>, and <a class="el" href="lmer_8c-source.html#l00466">mer_ST_setPars()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_c91a1d6467c5dd44cbc4c785f643e315_cgraph.png" border="0" usemap="#lmer_8c_c91a1d6467c5dd44cbc4c785f643e315_cgraph_map" alt=""></center>
<map name="lmer_8c_c91a1d6467c5dd44cbc4c785f643e315_cgraph_map">
<area shape="rect" href="lmer_8c.html#3f49a530ee30ef0d40ef8bc6d60c5963" title="Return the group in the (nf, Gp) combination to which ind belongs." alt="" coords="160,5,227,32"><area shape="rect" href="lmer_8c.html#3a7fab2a88117d83971db12f53eaa91e" title="Populate the st, nc and nlev arrays." alt="" coords="148,56,239,83"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_c91a1d6467c5dd44cbc4c785f643e315_icgraph.png" border="0" usemap="#lmer_8c_c91a1d6467c5dd44cbc4c785f643e315_icgraph_map" alt=""></center>
<map name="lmer_8c_c91a1d6467c5dd44cbc4c785f643e315_icgraph_map">
<area shape="rect" href="lmer_8h.html#a4e16de36d36af6c715d52a045f88e78" title="Optimize the profiled deviance of an lmer object or the Laplace approximation to..." alt="" coords="156,5,265,32"><area shape="rect" href="lmer_8h.html#96765a284e1652326a22d50f7d7538d4" title="Update the ST slot of an mer object from a REAL vector of parameters and update the..." alt="" coords="148,56,273,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="9812644aac7804e273e0a48e138eb9f9"></a><!-- doxytag: member="lmer.c::std_rWishart_factor" ref="9812644aac7804e273e0a48e138eb9f9" args="(double df, int p, int upper, double ans[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static double* std_rWishart_factor           </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>df</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>upper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>ans</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Simulate the Cholesky factor of a standardized Wishart variate with dimension p and df degrees of freedom. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>df</em>&nbsp;</td><td>degrees of freedom </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>p</em>&nbsp;</td><td>dimension of the Wishart distribution </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>upper</em>&nbsp;</td><td>if 0 the result is lower triangular, otherwise upper triangular </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ans</em>&nbsp;</td><td>array of size p * p to hold the result</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>ans </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l01400">1400</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01428">lme4_rWishart()</a>, and <a class="el" href="lmer_8c-source.html#l01538">MCMC_ST()</a>.</p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_9812644aac7804e273e0a48e138eb9f9_icgraph.png" border="0" usemap="#lmer_8c_9812644aac7804e273e0a48e138eb9f9_icgraph_map" alt=""></center>
<map name="lmer_8c_9812644aac7804e273e0a48e138eb9f9_icgraph_map">
<area shape="rect" href="lmer_8h.html#3e5fbf4c0511166682d134b8b4c68502" title="Simulate a sample of random matrices from a Wishart distribution." alt="" coords="201,5,313,32"><area shape="rect" href="lmer_8c.html#ef128b4cee2e476298b3b4388d8a2097" title="MCMC_ST" alt="" coords="213,56,301,83"><area shape="rect" href="lmer_8h.html#edec83b72f0c3437d9b10daf5120aa2b" title="Generate a Markov&#45;chain Monte Carlo sample from an mer object." alt="" coords="363,56,499,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="2f257f628f06920b351486d48ab50026"></a><!-- doxytag: member="lmer.c::update_L" ref="2f257f628f06920b351486d48ab50026" args="(SEXP x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static double update_L           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Update the A, L, sqrtrWt and resid slots. 
<p>
It is assumed that update_mu has already been called at the current values of u and the model parameters.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>pointer to an mer object</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>penalized weighted residual sum of squares </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00842">842</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>References <a class="el" href="lmer_8c-source.html#l00016">_</a>, <a class="el" href="lmer_8c-source.html#l00036">AZERO</a>, <a class="el" href="init_8c-source.html#l00034">c</a>, <a class="el" href="lmer_8c-source.html#l00070">L_SLOT</a>, <a class="el" href="lmer_8c-source.html#l00042">ldL2_POS</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_ASym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_CmSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_CxSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_devianceSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_dimsSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_muEtaSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_muSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_pWtSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_residSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_sqrtrWtSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_sqrtXWtSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_varSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_VSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_ySym</a>, <a class="el" href="lmer_8c-source.html#l00052">n_POS</a>, <a class="el" href="lmer_8c-source.html#l00044">pwrss_POS</a>, <a class="el" href="lmer_8c-source.html#l00055">s_POS</a>, <a class="el" href="lmer_8c-source.html#l00151">SLOT_REAL_NULL()</a>, <a class="el" href="lmer_8c-source.html#l00046">usqr_POS</a>, and <a class="el" href="lmer_8c-source.html#l00047">wrss_POS</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01319">mer_optimize()</a>, <a class="el" href="lmer_8c-source.html#l00951">mer_update_L()</a>, and <a class="el" href="lmer_8c-source.html#l00972">update_u()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_2f257f628f06920b351486d48ab50026_cgraph.png" border="0" usemap="#lmer_8c_2f257f628f06920b351486d48ab50026_cgraph_map" alt=""></center>
<map name="lmer_8c_2f257f628f06920b351486d48ab50026_cgraph_map">
<area shape="rect" href="lmer_8c.html#0a84fce1f01d522d8c5379001e23bc8c" title="Extract the slot named nm from the object obj and return a null pointer if the slot..." alt="" coords="137,5,279,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_2f257f628f06920b351486d48ab50026_icgraph.png" border="0" usemap="#lmer_8c_2f257f628f06920b351486d48ab50026_icgraph_map" alt=""></center>
<map name="lmer_8c_2f257f628f06920b351486d48ab50026_icgraph_map">
<area shape="rect" href="lmer_8h.html#a4e16de36d36af6c715d52a045f88e78" title="Optimize the profiled deviance of an lmer object or the Laplace approximation to..." alt="" coords="301,5,411,32"><area shape="rect" href="lmer_8h.html#f61a89a1f6aa003a5ae87d08cb8c9af7" title="Externally callable update_L." alt="" coords="136,31,251,57"><area shape="rect" href="lmer_8c.html#88236137756e85a656de3402adcf4747" title="Iterate to determine the conditional modes of the random effects." alt="" coords="153,81,233,108"><area shape="rect" href="lmer_8h.html#b72ec91b1f901b466f29a80bcc22e6c4" title="Externally callable update_u." alt="" coords="299,81,413,108"></map>
</div>

</div>
</div><p>
<a class="anchor" name="da558f58458c36a96585a9c6e695a0b6"></a><!-- doxytag: member="lmer.c::update_mu" ref="da558f58458c36a96585a9c6e695a0b6" args="(SEXP x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static double update_mu           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Update the eta, v, mu, resid and var slots according to the current values of the parameters and u. 
<p>
Also evaluate d[wrss_POS] using the current sqrtrWt slot. The sqrtrWt slot is changed in update_L.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>pointer to an mer object</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>penalized, weighted residual sum of squares </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00725">725</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>References <a class="el" href="lmer_8c-source.html#l00016">_</a>, <a class="el" href="init_8c-source.html#l00034">c</a>, <a class="el" href="lmer_8c-source.html#l00070">L_SLOT</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_ASym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_devianceSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_dimsSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_envSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_etaSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_fixefSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_gradientSym</a>, <a class="el" href="lmer_8c-source.html#l00588">lme4_muEta()</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_muEtaSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_muSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_nlmodelSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_offsetSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_residSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_sqrtrWtSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_uSym</a>, <a class="el" href="lmer_8c-source.html#l00636">lme4_varFunc()</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_varSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_VSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_XSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_ySym</a>, <a class="el" href="lmer_8c-source.html#l00059">lTyp_POS</a>, <a class="el" href="lmer_8c-source.html#l00052">n_POS</a>, <a class="el" href="lmer_8c-source.html#l00053">p_POS</a>, <a class="el" href="lmer_8c-source.html#l00044">pwrss_POS</a>, <a class="el" href="lmer_8c-source.html#l00054">q_POS</a>, <a class="el" href="lmer_8c-source.html#l00055">s_POS</a>, <a class="el" href="lmer_8c-source.html#l00151">SLOT_REAL_NULL()</a>, <a class="el" href="lmer_8c-source.html#l00080">sqr_length()</a>, <a class="el" href="lmer_8c-source.html#l00046">usqr_POS</a>, <a class="el" href="lmer_8c-source.html#l00060">vTyp_POS</a>, and <a class="el" href="lmer_8c-source.html#l00047">wrss_POS</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l00827">mer_update_mu()</a>, and <a class="el" href="lmer_8c-source.html#l00972">update_u()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_da558f58458c36a96585a9c6e695a0b6_cgraph.png" border="0" usemap="#lmer_8c_da558f58458c36a96585a9c6e695a0b6_cgraph_map" alt=""></center>
<map name="lmer_8c_da558f58458c36a96585a9c6e695a0b6_cgraph_map">
<area shape="rect" href="lmer_8c.html#4a0a18cf109ccc29a71a27a7f12bf4a7" title="lme4_muEta" alt="" coords="169,5,273,32"><area shape="rect" href="lmer_8c.html#a5f4cdbae42bcf865082dea1ebe09357" title="lme4_varFunc" alt="" coords="167,56,276,83"><area shape="rect" href="lmer_8c.html#0a84fce1f01d522d8c5379001e23bc8c" title="Extract the slot named nm from the object obj and return a null pointer if the slot..." alt="" coords="151,107,292,133"><area shape="rect" href="lmer_8c.html#c96e3dd08e67f41338d9e84118925308" title="Return the sum of squares of the first n elements of x." alt="" coords="177,157,265,184"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_da558f58458c36a96585a9c6e695a0b6_icgraph.png" border="0" usemap="#lmer_8c_da558f58458c36a96585a9c6e695a0b6_icgraph_map" alt=""></center>
<map name="lmer_8c_da558f58458c36a96585a9c6e695a0b6_icgraph_map">
<area shape="rect" href="lmer_8h.html#64740a858f90763461cbccea9c787b6b" title="Externally callable update_mu." alt="" coords="149,5,277,32"><area shape="rect" href="lmer_8c.html#88236137756e85a656de3402adcf4747" title="Iterate to determine the conditional modes of the random effects." alt="" coords="173,56,253,83"><area shape="rect" href="lmer_8h.html#a4e16de36d36af6c715d52a045f88e78" title="Optimize the profiled deviance of an lmer object or the Laplace approximation to..." alt="" coords="328,31,437,57"><area shape="rect" href="lmer_8h.html#b72ec91b1f901b466f29a80bcc22e6c4" title="Externally callable update_u." alt="" coords="325,81,440,108"></map>
</div>

</div>
</div><p>
<a class="anchor" name="5542c4de7dbcdbb6630cad8fabe96542"></a><!-- doxytag: member="lmer.c::update_ranef" ref="5542c4de7dbcdbb6630cad8fabe96542" args="(SEXP x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void update_ranef           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Update the contents of the ranef slot in an mer object. 
<p>
For a linear mixed model the conditional estimates of the fixed effects and the conditional mode of u are evaluated first.<p>
b = T *% S *% t(P) *% u<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>an mer object </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00253">253</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>References <a class="el" href="lmer_8c-source.html#l00016">_</a>, <a class="el" href="lmer_8c-source.html#l00033">Alloca</a>, <a class="el" href="init_8c-source.html#l00034">c</a>, <a class="el" href="lmer_8c-source.html#l00045">disc_POS</a>, <a class="el" href="lmer_8c-source.html#l00070">L_SLOT</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_devianceSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_dimsSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_fixefSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_GpSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_ranefSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_RCXySym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_RXySym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_sqrtXWtSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_STSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_uSym</a>, <a class="el" href="lmer_8c-source.html#l00053">p_POS</a>, <a class="el" href="lmer_8c-source.html#l00044">pwrss_POS</a>, <a class="el" href="lmer_8c-source.html#l00054">q_POS</a>, <a class="el" href="lmer_8c-source.html#l00151">SLOT_REAL_NULL()</a>, <a class="el" href="lmer_8c-source.html#l00080">sqr_length()</a>, <a class="el" href="lmer_8c-source.html#l00190">ST_nc_nlev()</a>, <a class="el" href="lmer_8c-source.html#l00046">usqr_POS</a>, and <a class="el" href="lmer_8c-source.html#l00047">wrss_POS</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01479">MCMC_beta()</a>, <a class="el" href="lmer_8c-source.html#l01633">mer_MCMCsamp()</a>, and <a class="el" href="lmer_8c-source.html#l01099">mer_update_ranef()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_5542c4de7dbcdbb6630cad8fabe96542_cgraph.png" border="0" usemap="#lmer_8c_5542c4de7dbcdbb6630cad8fabe96542_cgraph_map" alt=""></center>
<map name="lmer_8c_5542c4de7dbcdbb6630cad8fabe96542_cgraph_map">
<area shape="rect" href="lmer_8c.html#0a84fce1f01d522d8c5379001e23bc8c" title="Extract the slot named nm from the object obj and return a null pointer if the slot..." alt="" coords="164,5,305,32"><area shape="rect" href="lmer_8c.html#c96e3dd08e67f41338d9e84118925308" title="Return the sum of squares of the first n elements of x." alt="" coords="191,56,279,83"><area shape="rect" href="lmer_8c.html#3a7fab2a88117d83971db12f53eaa91e" title="Populate the st, nc and nlev arrays." alt="" coords="189,107,280,133"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_5542c4de7dbcdbb6630cad8fabe96542_icgraph.png" border="0" usemap="#lmer_8c_5542c4de7dbcdbb6630cad8fabe96542_icgraph_map" alt=""></center>
<map name="lmer_8c_5542c4de7dbcdbb6630cad8fabe96542_icgraph_map">
<area shape="rect" href="lmer_8c.html#f1bc9174690e2956720aa31781b073f0" title="Update the fixed effects in an MCMC sample from an mer object." alt="" coords="183,5,284,32"><area shape="rect" href="lmer_8h.html#edec83b72f0c3437d9b10daf5120aa2b" title="Generate a Markov&#45;chain Monte Carlo sample from an mer object." alt="" coords="352,31,488,57"><area shape="rect" href="lmer_8h.html#bc080c9abeb9965118c6d114d6df1cb3" title="Externally callable update_ranef." alt="" coords="163,107,304,133"></map>
</div>

</div>
</div><p>
<a class="anchor" name="2c7f7874e2eb3f6c51c53c5873cffec4"></a><!-- doxytag: member="lmer.c::update_RX" ref="2c7f7874e2eb3f6c51c53c5873cffec4" args="(SEXP x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static double update_RX           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Update the RCX and RX slots in an mer object. 
<p>
update_L should be called before update_RX<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>pointer to an mer object</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>profiled deviance or REML deviance </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l01206">1206</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>References <a class="el" href="lmer_8c-source.html#l00016">_</a>, <a class="el" href="lmer_8c-source.html#l00036">AZERO</a>, <a class="el" href="init_8c-source.html#l00034">c</a>, <a class="el" href="lmer_8c-source.html#l00057">isREML_POS</a>, <a class="el" href="lmer_8c-source.html#l00070">L_SLOT</a>, <a class="el" href="lmer_8c-source.html#l00042">ldL2_POS</a>, <a class="el" href="lmer_8c-source.html#l00043">ldRX2_POS</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_ASym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_CmSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_CxSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_devianceSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_dimsSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_fixefSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_muEtaSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_RCXySym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_RXySym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_sqrtXWtSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_uSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_VSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_XSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_ySym</a>, <a class="el" href="lmer_8c-source.html#l00040">ML_POS</a>, <a class="el" href="lmer_8c-source.html#l00052">n_POS</a>, <a class="el" href="lmer_8c-source.html#l00053">p_POS</a>, <a class="el" href="lmer_8c-source.html#l01181">P_sdmult()</a>, <a class="el" href="lmer_8c-source.html#l00044">pwrss_POS</a>, <a class="el" href="lmer_8c-source.html#l00054">q_POS</a>, <a class="el" href="lmer_8c-source.html#l00041">REML_POS</a>, <a class="el" href="lmer_8c-source.html#l00055">s_POS</a>, <a class="el" href="lmer_8c-source.html#l00151">SLOT_REAL_NULL()</a>, and <a class="el" href="lmer_8c-source.html#l00080">sqr_length()</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01319">mer_optimize()</a>, and <a class="el" href="lmer_8c-source.html#l01304">mer_update_RX()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_2c7f7874e2eb3f6c51c53c5873cffec4_cgraph.png" border="0" usemap="#lmer_8c_2c7f7874e2eb3f6c51c53c5873cffec4_cgraph_map" alt=""></center>
<map name="lmer_8c_2c7f7874e2eb3f6c51c53c5873cffec4_cgraph_map">
<area shape="rect" href="lmer_8c.html#d562658adcecf9b4a01944b227be5915" title="Create PAX in dest." alt="" coords="176,5,256,32"><area shape="rect" href="lmer_8c.html#0a84fce1f01d522d8c5379001e23bc8c" title="Extract the slot named nm from the object obj and return a null pointer if the slot..." alt="" coords="145,56,287,83"><area shape="rect" href="lmer_8c.html#c96e3dd08e67f41338d9e84118925308" title="Return the sum of squares of the first n elements of x." alt="" coords="172,107,260,133"><area shape="rect" href="lmer_8c.html#c6c092e8b91bd83d19519bdc69bf6801" title="Permute the vector src according to perm into dest." alt="" coords="337,5,433,32"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_2c7f7874e2eb3f6c51c53c5873cffec4_icgraph.png" border="0" usemap="#lmer_8c_2c7f7874e2eb3f6c51c53c5873cffec4_icgraph_map" alt=""></center>
<map name="lmer_8c_2c7f7874e2eb3f6c51c53c5873cffec4_icgraph_map">
<area shape="rect" href="lmer_8h.html#a4e16de36d36af6c715d52a045f88e78" title="Optimize the profiled deviance of an lmer object or the Laplace approximation to..." alt="" coords="152,5,261,32"><area shape="rect" href="lmer_8h.html#6c02b5f73d659d2d748852fac7e9c462" title="Externally callable update_RX." alt="" coords="145,56,268,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="88236137756e85a656de3402adcf4747"></a><!-- doxytag: member="lmer.c::update_u" ref="88236137756e85a656de3402adcf4747" args="(SEXP x, int verb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int update_u           </td>
          <td>(</td>
          <td class="paramtype">SEXP&nbsp;</td>
          <td class="paramname"> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>verb</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Iterate to determine the conditional modes of the random effects. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>pointer to an mer object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>verb</em>&nbsp;</td><td>indicator of verbose iterations (negative values produce a lot of output)</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>number of iterations to convergence (0 for non-convergence) </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00972">972</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>References <a class="el" href="lmer_8c-source.html#l00016">_</a>, <a class="el" href="lmer_8c-source.html#l00033">Alloca</a>, <a class="el" href="lmer_8c-source.html#l00100">apply_perm()</a>, <a class="el" href="lmer_8c-source.html#l00036">AZERO</a>, <a class="el" href="init_8c-source.html#l00034">c</a>, <a class="el" href="lmer_8c-source.html#l00957">CM_MAXITER</a>, <a class="el" href="lmer_8c-source.html#l00961">CM_SMIN</a>, <a class="el" href="lmer_8c-source.html#l00959">CM_TOL</a>, <a class="el" href="lmer_8c-source.html#l00070">L_SLOT</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_ASym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_CmSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_CxSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_dimsSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_residSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_sqrtXWtSym</a>, <a class="el" href="Syms_8h-source.html#l00003">lme4_uSym</a>, <a class="el" href="lmer_8c-source.html#l00052">n_POS</a>, <a class="el" href="lmer_8c-source.html#l00054">q_POS</a>, <a class="el" href="lmer_8c-source.html#l00151">SLOT_REAL_NULL()</a>, <a class="el" href="lmer_8c-source.html#l00080">sqr_length()</a>, <a class="el" href="lmer_8c-source.html#l00842">update_L()</a>, and <a class="el" href="lmer_8c-source.html#l00725">update_mu()</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l01319">mer_optimize()</a>, and <a class="el" href="lmer_8c-source.html#l01056">mer_update_u()</a>.</p>

<p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_88236137756e85a656de3402adcf4747_cgraph.png" border="0" usemap="#lmer_8c_88236137756e85a656de3402adcf4747_cgraph_map" alt=""></center>
<map name="lmer_8c_88236137756e85a656de3402adcf4747_cgraph_map">
<area shape="rect" href="lmer_8c.html#c6c092e8b91bd83d19519bdc69bf6801" title="Permute the vector src according to perm into dest." alt="" coords="137,5,233,32"><area shape="rect" href="lmer_8c.html#0a84fce1f01d522d8c5379001e23bc8c" title="Extract the slot named nm from the object obj and return a null pointer if the slot..." alt="" coords="284,107,425,133"><area shape="rect" href="lmer_8c.html#c96e3dd08e67f41338d9e84118925308" title="Return the sum of squares of the first n elements of x." alt="" coords="311,157,399,184"><area shape="rect" href="lmer_8c.html#2f257f628f06920b351486d48ab50026" title="Update the A, L, sqrtrWt and resid slots." alt="" coords="145,56,225,83"><area shape="rect" href="lmer_8c.html#da558f58458c36a96585a9c6e695a0b6" title="Update the eta, v, mu, resid and var slots according to the current values of the..." alt="" coords="139,208,232,235"><area shape="rect" href="lmer_8c.html#4a0a18cf109ccc29a71a27a7f12bf4a7" title="lme4_muEta" alt="" coords="303,208,407,235"><area shape="rect" href="lmer_8c.html#a5f4cdbae42bcf865082dea1ebe09357" title="lme4_varFunc" alt="" coords="300,259,409,285"></map>
</div>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_88236137756e85a656de3402adcf4747_icgraph.png" border="0" usemap="#lmer_8c_88236137756e85a656de3402adcf4747_icgraph_map" alt=""></center>
<map name="lmer_8c_88236137756e85a656de3402adcf4747_icgraph_map">
<area shape="rect" href="lmer_8h.html#a4e16de36d36af6c715d52a045f88e78" title="Optimize the profiled deviance of an lmer object or the Laplace approximation to..." alt="" coords="139,5,248,32"><area shape="rect" href="lmer_8h.html#b72ec91b1f901b466f29a80bcc22e6c4" title="Externally callable update_u." alt="" coords="136,56,251,83"></map>
</div>

</div>
</div><p>
<a class="anchor" name="5023a36a5ff0bec88db074b701eaf563"></a><!-- doxytag: member="lmer.c::y_log_y" ref="5023a36a5ff0bec88db074b701eaf563" args="(double y, double mu)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static R_INLINE double y_log_y           </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>mu</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Evaluate y * log(y/mu) with the correct limiting value at y = 0. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>y</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mu</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>y * log(y/mu) for y &gt; 0, 0 for y == 0. </dd></dl>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00679">679</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

<p>Referenced by <a class="el" href="lmer_8c-source.html#l00685">lme4_devResid()</a>.</p>

<p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
<p><center><img src="lmer_8c_5023a36a5ff0bec88db074b701eaf563_icgraph.png" border="0" usemap="#lmer_8c_5023a36a5ff0bec88db074b701eaf563_icgraph_map" alt=""></center>
<map name="lmer_8c_5023a36a5ff0bec88db074b701eaf563_icgraph_map">
<area shape="rect" href="lmer_8c.html#2f1d1f23db416c858fe8eecd2bb35236" title="lme4_devResid" alt="" coords="124,5,241,32"><area shape="rect" href="lmer_8h.html#c33b16395fa975458685d0eb76996f92" title="Evaluate the discrepancy and log of the penalized discrepancy." alt="" coords="291,5,421,32"></map>
</div>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="c2b5dcf1f18e620b15b2e284dd9f6bd4"></a><!-- doxytag: member="lmer.c::c" ref="c2b5dcf1f18e620b15b2e284dd9f6bd4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cholmod_common <a class="el" href="lmer_8c.html#c2b5dcf1f18e620b15b2e284dd9f6bd4">c</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
cholmod_common struct initialized in R_init_lme4 
<p>

<p>Definition at line <a class="el" href="init_8c-source.html#l00034">34</a> of file <a class="el" href="init_8c-source.html">init.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="ff6b0bb93de5846a13b97b193ae85a19"></a><!-- doxytag: member="lmer.c::INVEPS" ref="ff6b0bb93de5846a13b97b193ae85a19" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const double <a class="el" href="lmer_8c.html#ff6b0bb93de5846a13b97b193ae85a19">INVEPS</a> = 1/DOUBLE_EPS<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00585">585</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="19bc482347f198c78c8fcfb3e2510425"></a><!-- doxytag: member="lmer.c::LTHRESH" ref="19bc482347f198c78c8fcfb3e2510425" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const double <a class="el" href="lmer_8c.html#19bc482347f198c78c8fcfb3e2510425">LTHRESH</a> = 30.<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00581">581</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="6b3a6b2cbf7064ca416501ccda92fbb9"></a><!-- doxytag: member="lmer.c::MLTHRESH" ref="6b3a6b2cbf7064ca416501ccda92fbb9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const double <a class="el" href="lmer_8c.html#6b3a6b2cbf7064ca416501ccda92fbb9">MLTHRESH</a> = -30.<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00582">582</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="b3b4cee60f1fb4a51a943b4e14ca01e1"></a><!-- doxytag: member="lmer.c::MPTHRESH" ref="b3b4cee60f1fb4a51a943b4e14ca01e1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="lmer_8c.html#b3b4cee60f1fb4a51a943b4e14ca01e1">MPTHRESH</a> = 0<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00583">583</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="facf87e3fb517a5633a98660f2d34b87"></a><!-- doxytag: member="lmer.c::PTHRESH" ref="facf87e3fb517a5633a98660f2d34b87" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="lmer_8c.html#facf87e3fb517a5633a98660f2d34b87">PTHRESH</a> = 0<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="lmer_8c-source.html#l00584">584</a> of file <a class="el" href="lmer_8c-source.html">lmer.c</a>.</p>

</div>
</div><p>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Feb 1 11:00:47 2008 for lme4 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.3 </small></address>
</body>
</html>
